<!DOCTYPE html><html xmlns:cc="http://creativecommons.org/ns#"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# medium-com: http://ogp.me/ns/fb/medium-com#"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=contain"><title>Top Five Ways I Got Domain Admin on Your Internal Network before Lunch (2018 Edition)</title><link rel="canonical" href="https://medium.com/@adam.toscher/top-five-ways-i-got-domain-admin-on-your-internal-network-before-lunch-2018-edition-82259ab73aaa"><meta name="title" content="Top Five Ways I Got Domain Admin on Your Internal Network before Lunch (2018 Edition)"><meta name="referrer" content="unsafe-url"><meta name="description" content="A Scary Thought: I’ve worked in the Cyber Security space performing a wide breadth of penetration and red team services for years. Yes it’s still as easy (if not more so in this day and age!) to…"><meta name="theme-color" content="#000000"><meta property="og:title" content="Top Five Ways I Got Domain Admin on Your Internal Network before Lunch (2018 Edition)"><meta property="og:url" content="https://medium.com/@adam.toscher/top-five-ways-i-got-domain-admin-on-your-internal-network-before-lunch-2018-edition-82259ab73aaa"><meta property="og:image" content="https://cdn-images-1.medium.com/max/1200/1*vnEng8O4sGJ1DENY2SmiqA.png"><meta property="fb:app_id" content="542599432471018"><meta property="og:description" content="A Scary Thought: I’ve worked in the Cyber Security space performing a wide breadth of penetration and red team services for years."><meta name="twitter:description" content="A Scary Thought: I’ve worked in the Cyber Security space performing a wide breadth of penetration and red team services for years."><meta name="twitter:image:src" content="https://cdn-images-1.medium.com/max/1200/1*vnEng8O4sGJ1DENY2SmiqA.png"><link rel="publisher" href="https://plus.google.com/103654360130207659246"><link rel="author" href="https://medium.com/@adam.toscher"><meta property="author" content="Adam Toscher"><meta property="og:type" content="article"><meta name="twitter:card" content="summary_large_image"><meta property="article:publisher" content="https://www.facebook.com/medium"><meta property="article:author" content="https://medium.com/@adam.toscher"><meta name="robots" content="index, follow"><meta property="article:published_time" content="2018-03-09T19:45:48.380Z"><meta name="twitter:site" content="@Medium"><meta property="og:site_name" content="Medium"><meta name="twitter:label1" value="Reading time"><meta name="twitter:data1" value="8 min read"><meta name="twitter:app:name:iphone" content="Medium"><meta name="twitter:app:id:iphone" content="828256236"><meta name="twitter:app:url:iphone" content="medium://p/82259ab73aaa"><meta property="al:ios:app_name" content="Medium"><meta property="al:ios:app_store_id" content="828256236"><meta property="al:android:package" content="com.medium.reader"><meta property="al:android:app_name" content="Medium"><meta property="al:ios:url" content="medium://p/82259ab73aaa"><meta property="al:android:url" content="medium://p/82259ab73aaa"><meta property="al:web:url" content="https://medium.com/@adam.toscher/top-five-ways-i-got-domain-admin-on-your-internal-network-before-lunch-2018-edition-82259ab73aaa"><link rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml" /><link rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/82259ab73aaa" /><script type="application/ld+json">{"@context":"http://schema.org","@type":"NewsArticle","image":{"@type":"ImageObject","width":1920,"height":1315,"url":"https://cdn-images-1.medium.com/max/2000/1*vnEng8O4sGJ1DENY2SmiqA.png"},"datePublished":"2018-03-09T19:45:48.380Z","dateModified":"2018-03-10T04:57:44.244Z","headline":"Top Five Ways I Got Domain Admin on Your Internal Network before Lunch (2018 Edition)","name":"Top Five Ways I Got Domain Admin on Your Internal Network before Lunch (2018 Edition)","keywords":["Penetration Testing","Security","Cybersecurity","Hacking"],"author":{"@type":"Person","name":"Adam Toscher","url":"https://medium.com/@adam.toscher"},"creator":["Adam Toscher"],"publisher":{"@type":"Organization","name":"Medium","url":"https://medium.com/","logo":{"@type":"ImageObject","width":308,"height":60,"url":"https://cdn-images-1.medium.com/max/616/1*OMF3fSqH8t4xBJ9-6oZDZw.png"}},"mainEntityOfPage":"https://medium.com/@adam.toscher/top-five-ways-i-got-domain-admin-on-your-internal-network-before-lunch-2018-edition-82259ab73aaa"}</script><link rel="stylesheet" href="https://cdn-static-1.medium.com/_/fp/css/main-branding-base.hYiEpYs3x8GgQzREEhW49Q.css"><script>if (window.top !== window.self) window.top.location = window.self.location.href;var OB_startTime = new Date().getTime(); var OB_loadErrors = []; function _onerror(e) { OB_loadErrors.push(e) }; if (document.addEventListener) document.addEventListener("error", _onerror, true); else if (document.attachEvent) document.attachEvent("onerror", _onerror); function _asyncScript(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("script"); s.type = "text/javascript"; s.async = true; s.src = u; f.parentNode.insertBefore(s, f);}function _asyncStyles(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("link"); s.rel = "stylesheet"; s.href = u; f.parentNode.insertBefore(s, f); return s}(new Image()).src = "/_/stat?event=pixel.load&origin=" + encodeURIComponent(location.origin);</script><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date; ga("create", "UA-24232453-2", "auto", {"allowLinker": true, "legacyCookieDomain": window.location.hostname}); ga("send", "pageview");</script><script async src="https://www.google-analytics.com/analytics.js"></script><script>(function () {var height = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight; var width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth; document.write("<style>section.section-image--fullBleed.is-backgrounded {padding-top: " + Math.round(1.1 * height) + "px;}section.section-image--fullScreen.is-backgrounded, section.section-image--coverFade.is-backgrounded {min-height: " + height + "px; padding-top: " + Math.round(0.5 * height) + "px;}.u-sizeViewHeight100 {height: " + height + "px !important;}.u-sizeViewHeight110 {height: " + Math.round(1.1 * height) + "px !important;}.u-sizeViewHeightMin100 {min-height: " + height + "px !important;}.u-sizeViewHeightMax100 {max-height: " + height + "px !important;}section.section-image--coverFade {height: " + height + "px;}.section-aspectRatioViewportPlaceholder, .section-aspectRatioViewportCropPlaceholder {max-height: " + height + "px;}.section-aspectRatioViewportBottomSpacer, .section-aspectRatioViewportBottomPlaceholder {max-height: " + Math.round(0.5 * height) + "px;}.zoomable:before {top: " + (-1 * height) + "px; left: " + (-1 * width) + "px; padding: " + height + "px " + width + "px;}</style>");})()</script><!--[if lt IE 9]><script charset="UTF-8" src="https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js"></script><![endif]--><link rel="icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico" class="js-favicon"><link rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/304/304/1*8I-HPL0bfoIzGied-dzOvA.png"><link rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/240/240/1*8I-HPL0bfoIzGied-dzOvA.png"><link rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/152/152/1*8I-HPL0bfoIzGied-dzOvA.png"><link rel="apple-touch-icon" sizes="60x60" href="https://cdn-images-1.medium.com/fit/c/120/120/1*8I-HPL0bfoIzGied-dzOvA.png"><link rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg" color="#171717"></head><body itemscope class=" postShowScreen v-glyph v-glyph--m2 v-enableBrandingButtons is-noJs"><script>document.body.className = document.body.className.replace(/(^|\s)is-noJs(\s|$)/, "$1is-js$2")</script><div class="site-main" id="container"><div class="butterBar butterBar--error"></div><div class="surface"><div id="prerendered" class="screenContent"><canvas class="canvas-renderer"></canvas><div class="container u-maxWidth740 u-xs-margin0 notesPositionContainer js-notesPositionContainer"></div><div class="metabar u-clearfix js-metabar u-fixed u-backgroundTransparentWhiteDarkest u-xs-sizeFullViewportWidth"><div class="js-metabarMiddle metabar-inner u-marginAuto u-maxWidth1000 u-flexCenter u-justifyContentSpaceBetween u-height65 u-xs-height56 u-paddingLeft20 u-paddingRight20"><div class="metabar-block u-flex1 u-flexCenter"><div class="js-metabarLogoLeft u-xs-show"><a href="https://medium.com/" data-log-event="home" class="siteNav-logo"><span class="svgIcon svgIcon--logoWordmark svgIcon--138x27px is-flushLeft u-xs-hide u-textColorDarker"><svg class="svgIcon-use" width="138" height="27" viewBox="0 0 138 27" ><path d="M130 27V16.96c0-3.26-.154-5.472-2.437-5.472-1.16 0-2.138.57-2.863 1.512.217.906.3 1.968.3 3.127 0 2.247.036 5.11 0 7.973 0 .472-.046.58.244.87L127 27h-8V16.96c0-3.297-.461-5.472-2.708-5.472-1.16 0-1.64.653-2.292 1.595V24.1c0 .472-.026.58.3.87L116 27h-8V11.56c0-.47-.07-.579-.36-.905L106 9h8v3.612c.906-2.537 2.437-4.112 5.372-4.112 2.682 0 4.494 1.466 5.255 4.257.834-2.392 3.008-4.257 6.053-4.257 3.588 0 5.32 2.626 5.32 7.627 0 2.392.036 5.11 0 7.973 0 .472.004.652.25.87L138 27h-8zm-27-3.045c0 .472-.149.617.178.906L105 27h-8v-4c-.906 2.465-2.956 4-5.637 4C87.775 27 86 24.39 86 19.461c0-2.391-.036-5 0-7.936 0-.471-.11-.58-.4-.87L84 9h8v9.628c0 3.225.269 5.4 2.298 5.4 1.16 0 2.086-.725 2.702-1.63V11.56c0-.471-.129-.58-.419-.906L95 9h8v14.955zM78.002.25A3.248 3.248 0 0 1 81.25 3.5 3.25 3.25 0 1 1 78.002.25zM75 27V11.56c0-.47.168-.579-.122-.905L73 9h8v15.1c0 .472-.01.678.24.9L83 27h-8zM64 11.706c-.507-.652-1.418-1.123-2.396-1.123-1.957 0-3.842 1.775-3.842 7.03 0 4.93 1.631 6.669 3.66 6.669.907 0 1.853-.436 2.578-1.378V11.706zm6 12.286c0 .47-.026.58.3.87L72 27h-8v-3.697C62.913 25.804 60.951 27 58.632 27 54.5 27 51.5 23.738 51.5 17.795c0-5.582 3.254-9.314 7.784-9.314 2.356 0 3.919 1.123 4.716 2.899V3.878c0-.471-.077-.617-.403-.906L62 1.305 70 .29v23.702zM43.9 16c.037-.471.037-.67.037-.815 0-4.747-.937-5.435-2.437-5.435-1.5 0-2.854.995-2.927 6.25h5.328zm-5.327 1c0 4.711 2.392 6.63 5.183 6.63 2.174 0 4.313-.943 5.509-3.335h.072c-.942 4.566-3.77 6.705-8.01 6.705-4.566 0-8.879-2.755-8.879-9.133 0-6.705 4.277-9.386 9.097-9.386 3.842 0 7.937 1.811 7.937 7.646 0 .109 0 .438-.036.873H38.573zM31.5 27h-12l2.39-2.646c.084-.084.11-.399.11-.87V7l-7.866 20L5.581 8.372C5.364 7.9 5.181 7.285 5 6.777V20.62c0 .58-.035.653.364 1.196L9 27H0l3.64-5.183c.399-.543.36-.616.36-1.196V6.27c0-.617.095-.69-.195-1.051L1 1h8.495l7.355 16.3L23.24 1h8.26l-2.2 2.75c-.326.326-.3.599-.3 1.106v18.629c0 .47.005.75.138.87L31.5 27z"/></svg></span><span class="svgIcon svgIcon--logoWordmark svgIcon--122x45px is-flushLeft u-xs-show u-textColorDarker"><svg class="svgIcon-use" width="122" height="45" viewBox="0 0 122 45" ><path d="M61.6 31.806c0 .412 0 .505.28.758l1.574 1.537v.065h-6.979v-2.95a4.852 4.852 0 0 1-4.627 3.203c-3.588 0-6.192-2.81-6.192-7.981 0-4.843 2.81-8.075 6.754-8.075a4.122 4.122 0 0 1 4.056 2.51v-6.51a.806.806 0 0 0-.319-.787l-1.499-1.443v-.065l6.951-.815v20.553zm-5.125-.937v-9.714a2.614 2.614 0 0 0-2.08-.975c-1.695 0-3.334 1.537-3.334 6.099 0 4.271 1.414 5.78 3.175 5.78a2.81 2.81 0 0 0 2.24-1.19zm9.752 3.297V21.051a.88.88 0 0 0-.281-.786L64.4 18.672v-.065h6.98v13.302c0 .412 0 .505.28.758l1.536 1.443v.066l-6.97-.01zm-.253-20.356a2.81 2.81 0 1 1 5.62 0 2.81 2.81 0 0 1-5.62 0zm24.234 17.967c0 .413 0 .534.281.787l1.574 1.537v.065h-7.017v-3.363a5.077 5.077 0 0 1-4.805 3.616c-3.11 0-4.778-2.267-4.778-6.557 0-2.07 0-4.337.066-6.885a.796.796 0 0 0-.281-.76l-1.546-1.545v-.065h6.923v8.552c0 2.81.412 4.684 2.173 4.684a2.81 2.81 0 0 0 2.267-1.415v-9.367a.88.88 0 0 0-.28-.787l-1.556-1.602v-.065h6.979v13.17zm23.756 2.39c0-.507.094-6.952.094-8.432 0-2.81-.44-4.75-2.417-4.75a3.138 3.138 0 0 0-2.482 1.35c.198.876.292 1.772.28 2.67 0 1.948-.065 4.43-.093 6.913a.796.796 0 0 0 .281.759l1.574 1.442v.066h-7.045c0-.468.094-6.95.094-8.431 0-2.857-.44-4.75-2.389-4.75a2.81 2.81 0 0 0-2.323 1.387v9.555c0 .412 0 .506.281.759l1.537 1.442v.066h-6.97V21.098a.88.88 0 0 0-.281-.787l-1.546-1.639v-.065h6.98v3.334a5.002 5.002 0 0 1 5.002-3.587c2.323 0 3.896 1.292 4.562 3.747a5.433 5.433 0 0 1 5.245-3.747c3.11 0 4.872 2.295 4.872 6.632 0 2.07-.066 4.43-.094 6.913a.75.75 0 0 0 .318.759l1.537 1.443v.065h-7.017zm-87.671-2.043l2.07 1.977v.065H17.862v-.065l2.107-1.977a.796.796 0 0 0 .281-.759V18.728c0-.534 0-1.255.094-1.873l-7.082 17.564h-.084L5.843 18.26c-.16-.402-.206-.43-.31-.702v10.595c-.087.71.034 1.429.348 2.07l2.95 3.879v.065H1v-.065l2.95-3.888a3.69 3.69 0 0 0 .347-2.06v-11.71a2.267 2.267 0 0 0-.487-1.602l-2.089-2.708v-.065h7.494l6.277 13.686 5.527-13.686h7.335v.065l-2.061 2.296a.806.806 0 0 0-.319.786v16.15a.75.75 0 0 0 .319.759zm8.215-6.332v.065c0 4.01 2.07 5.62 4.497 5.62a5.105 5.105 0 0 0 4.777-2.894h.066c-.844 3.963-3.298 5.836-6.97 5.836-3.962 0-7.7-2.389-7.7-7.925 0-5.817 3.747-8.14 7.887-8.14 3.335 0 6.886 1.573 6.886 6.632v.806h-9.443zm0-.806h4.618v-.815c0-4.122-.852-5.218-2.136-5.218-1.555 0-2.5 1.64-2.5 6.033h.018z"/></svg></span><span class="u-textScreenReader">Homepage</span></a></div><a class="link link--darken u-accentColor--textDarken u-baseColor--link u-xs-hide js-upgradeMembershipAction"   href="https://medium.com/membership?source=upgrade_membership---nav_full">About membership</a></div><div class="metabar-block u-flex0"><div class="buttonSet buttonSet--wide"><a class="button button--primary button--chromeless u-accentColor--buttonNormal is-inSiteNavBar u-xs-hide js-signInButton"   href="https://medium.com/m/signin?redirect=https%3A%2F%2Fmedium.com%2F%40adam.toscher%2Ftop-five-ways-i-got-domain-admin-on-your-internal-network-before-lunch-2018-edition-82259ab73aaa&amp;source=--------------------------nav_reg&amp;operation=login" data-action="sign-in-prompt" data-redirect="https://medium.com/@adam.toscher/top-five-ways-i-got-domain-admin-on-your-internal-network-before-lunch-2018-edition-82259ab73aaa" data-action-source="--------------------------nav_reg">Sign in</a><a class="button button--primary button--withChrome u-accentColor--buttonNormal is-inSiteNavBar js-signUpButton"   href="https://medium.com/m/signin?redirect=https%3A%2F%2Fmedium.com%2F%40adam.toscher%2Ftop-five-ways-i-got-domain-admin-on-your-internal-network-before-lunch-2018-edition-82259ab73aaa&amp;source=--------------------------nav_reg&amp;operation=register" data-action="sign-up-prompt" data-redirect="https://medium.com/@adam.toscher/top-five-ways-i-got-domain-admin-on-your-internal-network-before-lunch-2018-edition-82259ab73aaa" data-action-source="--------------------------nav_reg">Get started</a></div></div><div class="u-absolute u-sizeFullWidth u-top0 u-right0 u-bottom0 u-flexCenter u-justifyContentCenter u-textAlignCenter u-xs-hide js-metabarLogoCentered"><a href="https://medium.com/" data-log-event="home" class="siteNav-logo"><span class="svgIcon svgIcon--logoWordmark svgIcon--138x27px is-flushLeft u-xs-hide u-textColorDarker"><svg class="svgIcon-use" width="138" height="27" viewBox="0 0 138 27" ><path d="M130 27V16.96c0-3.26-.154-5.472-2.437-5.472-1.16 0-2.138.57-2.863 1.512.217.906.3 1.968.3 3.127 0 2.247.036 5.11 0 7.973 0 .472-.046.58.244.87L127 27h-8V16.96c0-3.297-.461-5.472-2.708-5.472-1.16 0-1.64.653-2.292 1.595V24.1c0 .472-.026.58.3.87L116 27h-8V11.56c0-.47-.07-.579-.36-.905L106 9h8v3.612c.906-2.537 2.437-4.112 5.372-4.112 2.682 0 4.494 1.466 5.255 4.257.834-2.392 3.008-4.257 6.053-4.257 3.588 0 5.32 2.626 5.32 7.627 0 2.392.036 5.11 0 7.973 0 .472.004.652.25.87L138 27h-8zm-27-3.045c0 .472-.149.617.178.906L105 27h-8v-4c-.906 2.465-2.956 4-5.637 4C87.775 27 86 24.39 86 19.461c0-2.391-.036-5 0-7.936 0-.471-.11-.58-.4-.87L84 9h8v9.628c0 3.225.269 5.4 2.298 5.4 1.16 0 2.086-.725 2.702-1.63V11.56c0-.471-.129-.58-.419-.906L95 9h8v14.955zM78.002.25A3.248 3.248 0 0 1 81.25 3.5 3.25 3.25 0 1 1 78.002.25zM75 27V11.56c0-.47.168-.579-.122-.905L73 9h8v15.1c0 .472-.01.678.24.9L83 27h-8zM64 11.706c-.507-.652-1.418-1.123-2.396-1.123-1.957 0-3.842 1.775-3.842 7.03 0 4.93 1.631 6.669 3.66 6.669.907 0 1.853-.436 2.578-1.378V11.706zm6 12.286c0 .47-.026.58.3.87L72 27h-8v-3.697C62.913 25.804 60.951 27 58.632 27 54.5 27 51.5 23.738 51.5 17.795c0-5.582 3.254-9.314 7.784-9.314 2.356 0 3.919 1.123 4.716 2.899V3.878c0-.471-.077-.617-.403-.906L62 1.305 70 .29v23.702zM43.9 16c.037-.471.037-.67.037-.815 0-4.747-.937-5.435-2.437-5.435-1.5 0-2.854.995-2.927 6.25h5.328zm-5.327 1c0 4.711 2.392 6.63 5.183 6.63 2.174 0 4.313-.943 5.509-3.335h.072c-.942 4.566-3.77 6.705-8.01 6.705-4.566 0-8.879-2.755-8.879-9.133 0-6.705 4.277-9.386 9.097-9.386 3.842 0 7.937 1.811 7.937 7.646 0 .109 0 .438-.036.873H38.573zM31.5 27h-12l2.39-2.646c.084-.084.11-.399.11-.87V7l-7.866 20L5.581 8.372C5.364 7.9 5.181 7.285 5 6.777V20.62c0 .58-.035.653.364 1.196L9 27H0l3.64-5.183c.399-.543.36-.616.36-1.196V6.27c0-.617.095-.69-.195-1.051L1 1h8.495l7.355 16.3L23.24 1h8.26l-2.2 2.75c-.326.326-.3.599-.3 1.106v18.629c0 .47.005.75.138.87L31.5 27z"/></svg></span><span class="u-textScreenReader">Homepage</span></a></div></div></div><div class="metabar metabar--spacer js-metabarSpacer u-height65 u-xs-height56"></div><main role="main"><article class=" u-minHeight100vhOffset65 u-overflowHidden postArticle postArticle--full u-marginBottom40"  lang="en"><header class="container u-maxWidth740"><div class="uiScale uiScale-ui--regular uiScale-caption--regular postMetaHeader u-paddingBottom10 row"><div class="col u-size12of12 js-postMetaLockup"><div class="uiScale uiScale-ui--regular uiScale-caption--regular postMetaLockup postMetaLockup--authorWithBio u-flexCenter js-postMetaLockup"><div class="u-flex0"><a class="link u-baseColor--link avatar"   href="https://medium.com/@adam.toscher?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-value="626cae9ed375" data-action-type="hover" data-user-id="626cae9ed375" dir="auto"><div class="u-relative u-inlineBlock u-flex0"><img  src="https://cdn-images-1.medium.com/fit/c/120/120/0*s_J0fTAsy4Azb0dt." class="avatar-image avatar-image--small" alt="Go to the profile of Adam Toscher"><div class="avatar-halo u-absolute u-textColorGreenNormal svgIcon" style="width: calc(100% + 12px); height: calc(100% + 12px); top:-6px; left:-6px"><svg viewBox="0 0 114 114" xmlns="http://www.w3.org/2000/svg"><path d="M7.66922967,32.092726 C17.0070768,13.6353618 35.9421928,1.75 57,1.75 C78.0578072,1.75 96.9929232,13.6353618 106.33077,32.092726 L107.66923,31.4155801 C98.0784505,12.4582656 78.6289015,0.25 57,0.25 C35.3710985,0.25 15.9215495,12.4582656 6.33077033,31.4155801 L7.66922967,32.092726 Z"></path><path d="M106.33077,81.661427 C96.9929232,100.118791 78.0578072,112.004153 57,112.004153 C35.9421928,112.004153 17.0070768,100.118791 7.66922967,81.661427 L6.33077033,82.338573 C15.9215495,101.295887 35.3710985,113.504153 57,113.504153 C78.6289015,113.504153 98.0784505,101.295887 107.66923,82.338573 L106.33077,81.661427 Z"></path></svg></div></div></a></div><div class="u-flex1 u-paddingLeft15 u-overflowHidden"><div class="u-lineHeightTightest"><a class="ds-link ds-link--styleSubtle ui-captionStrong u-inlineBlock link link--darken link--darker"   href="https://medium.com/@adam.toscher?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-value="626cae9ed375" data-action-type="hover" data-user-id="626cae9ed375" dir="auto">Adam Toscher</a><span class="followState js-followState" data-user-id="626cae9ed375"><button class="button button--smallest u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-marginLeft10 u-xs-hide"  data-action="sign-up-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-redirect="https://medium.com/@adam.toscher/top-five-ways-i-got-domain-admin-on-your-internal-network-before-lunch-2018-edition-82259ab73aaa" data-action-source="post_header_lockup"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--smallest u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton u-marginLeft10 u-xs-hide"  data-action="sign-up-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/626cae9ed375" data-action-source="post_header_lockup-626cae9ed375-------------------------follow_byline"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="ui-caption ui-xs-clamp2 postMetaInline">Adam is an independent penetration tester who has over 20 years of experience in the technology industry.</div><div class="ui-caption postMetaInline js-testPostMetaInlineSupplemental"><time datetime="2018-03-09T19:45:48.380Z">Mar 9</time><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="8 min read"></span></div></div></div></div></div></header><div class="postArticle-content js-postField js-notesSource js-trackedPost"  data-post-id="82259ab73aaa" data-source="post_page" data-tracking-context="postPage"><section name="7b1a" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h1 name="5f23" id="5f23" class="graf graf--h3 graf--leading graf--title">Top Five Ways I Got Domain Admin on Your Internal Network before Lunch (2018 Edition)</h1><p name="7f3a" id="7f3a" class="graf graf--p graf-after--h3">A Scary Thought: I’ve worked in the Cyber Security space performing a wide breadth of penetration and red team services for years. Yes it’s still as easy (if not more so in this day and age!) to obtain Domain Admin “before lunch” as it was when I first started pen-testing.</p><p name="d9e0" id="d9e0" class="graf graf--p graf-after--p">Back in September of 2013, Spider Labs wrote an article titled “<a href="https://www.trustwave.com/Resources/SpiderLabs-Blog/Top-Five-Ways-SpiderLabs-Got-Domain-Admin-on-Your-Internal-Network/" data-href="https://www.trustwave.com/Resources/SpiderLabs-Blog/Top-Five-Ways-SpiderLabs-Got-Domain-Admin-on-Your-Internal-Network/" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank"><strong class="markup--strong markup--p-strong">Top Five Ways SpiderLabs Got Domain Admin on Your Internal Network</strong></a><strong class="markup--strong markup--p-strong">” </strong>This article is written to compliment and serve as a Part 2 of sorts to the original SpiderLabs Blog post.</p><ol class="postList"><li name="cb2c" id="cb2c" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">Netbios and LLMNR Name Poisoning</strong></li></ol><blockquote name="6ba3" id="6ba3" class="graf graf--pullquote graf-after--li">I wish I could say that Netbios/LLMNR is not as prevalent as it was in 2013; but a vast majority of assessments, result in pen testers obtaining hashes, and reversing NTLMv1/v2 hashes and recovering plain text credentials. To assist you with your recently recovered hashes, there are now advanced frameworks to help with password cracking like <a href="https://github.com/trustedsec/hate_crack" data-href="https://github.com/trustedsec/hate_crack" class="markup--anchor markup--pullquote-anchor" rel="noopener nofollow" target="_blank">hate_crack</a>.</blockquote><blockquote name="82db" id="82db" class="graf graf--pullquote graf-after--pullquote">I personally had great success using a common wordlist that can be obtained for a nominal fee: “<a href="https://webcache.googleusercontent.com/search?q=cache:BV8AEB0cWtcJ:https://dazzlepod.com/uniqpass/+&amp;cd=1&amp;hl=en&amp;ct=clnk&amp;gl=us" data-href="https://webcache.googleusercontent.com/search?q=cache:BV8AEB0cWtcJ:https://dazzlepod.com/uniqpass/+&amp;cd=1&amp;hl=en&amp;ct=clnk&amp;gl=us" class="markup--anchor markup--pullquote-anchor" rel="noopener nofollow" target="_blank">uniqpass</a>” and the out of box common hashcat ruleset “best64”. But sometimes complex passwords are enforced, and you’re left with no other option but to crack some hashes.</blockquote><blockquote name="67ce" id="67ce" class="graf graf--pullquote graf-after--pullquote"><a href="https://github.com/lgandx/Responder" data-href="https://github.com/lgandx/Responder" class="markup--anchor markup--pullquote-anchor" rel="noopener nofollow" target="_blank">Responder,</a> thought not actively maintained by Spider Labs is still arguably the go to tool for all things related to mitm poisoning and spoofing.</blockquote><p name="058a" id="058a" class="graf graf--p graf-after--pullquote"><a href="https://github.com/Kevin-Robertson/Inveigh" data-href="https://github.com/Kevin-Robertson/Inveigh" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">Inveigh</a>, the native Windows .NET sibling of the Unix/Linux Python based Responder</p><blockquote name="f6d8" id="f6d8" class="graf graf--pullquote graf-after--p">Inveigh its core is a .NET packet sniffer that listens for and responds to LLMNR/mDNS/NBNS requests while also capturing incoming NTLMv1/NTLMv2 authentication attempts over the Windows SMB service.</blockquote><p name="d59b" id="d59b" class="graf graf--p graf-after--pullquote">Both man-in-the-middle tools are designed to assist penetration testers/red teamers that find themselves limited to a Windows system.</p><p name="a947" id="a947" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">2. Relay attacks</strong></p><p name="aec5" id="aec5" class="graf graf--p graf-after--p">The newer MultiReplay tool is maintained by: Laurent Gaffie, which is designed for seem-less integration with the Responder framework for easing the difficulty when performing SMB relay attacks.</p><p name="0ef7" id="0ef7" class="graf graf--p graf-after--p">I personally prefer impacket’s tools, for relaying and other penetration testing needs. Impacket’s tools I find to be reliable and stable on most unixes and run natively on Mac OS. Comparatively to other free open source tools, they leave a relatively small forensic footprint when executed on a host (If you’re worried about noise, are trying to be evasive, or have to fend off a Blue Team).</p><p name="5c88" id="5c88" class="graf graf--p graf-after--p">To prepare for some DA pwnage lets get <a href="https://github.com/CoreSecurity/impacket" data-href="https://github.com/CoreSecurity/impacket" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">impacke</a>t installed.</p><h3 name="c940" id="c940" class="graf graf--h3 graf-after--p"><strong class="markup--strong markup--h3-strong">SMB Relaying explained:</strong></h3><p name="df32" id="df32" class="graf graf--p graf-after--h3"><a href="https://github.com/CoreSecurity/impacket/blob/impacket_0_9_15/examples/smbrelayx.py" data-href="https://github.com/CoreSecurity/impacket/blob/impacket_0_9_15/examples/smbrelayx.py" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><strong class="markup--strong markup--p-strong">smbrelayx.py</strong></a></p><blockquote name="0f01" id="0f01" class="graf graf--pullquote graf-after--p">This module performs the SMB Relay attacks originally discovered by cDc. It receives a list of targets and for every connection received it will choose the next target and try to relay the credentials. Also, if specified, it will first to try authenticate against the client connecting to us.<br>It is implemented by invoking a SMB and HTTP Server, hooking to a few functions and then using the smbclient portion. It is supposed to be working on any LM Compatibility level. The only way to stop this attack is to enforce on the server SPN checks and or signing. If the authentication against the targets succeed, the client authentication success as well and a valid connection is set against the local smbserver. It’s up to the user to set up the local smbserver functionality. One option is to set up shares with whatever files you want to the victim thinks it’s connected to a valid SMB server. All that is done through the smb.conf file or programmatically.</blockquote><h3 name="3545" id="3545" class="graf graf--h3 graf-after--pullquote"><a href="https://www.fox-it.com/en/insights/blogs/blog/inside-windows-network/" data-href="https://www.fox-it.com/en/insights/blogs/blog/inside-windows-network/" class="markup--anchor markup--h3-anchor" rel="nofollow noopener" target="_blank"><strong class="markup--strong markup--h3-strong">NTLM Relaying explained</strong></a></h3><p name="2173" id="2173" class="graf graf--p graf-after--h3"><a href="https://github.com/CoreSecurity/impacket/blob/master/examples/ntlmrelayx.py" data-href="https://github.com/CoreSecurity/impacket/blob/master/examples/ntlmrelayx.py" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><strong class="markup--strong markup--p-strong">ntlmrelayx.py</strong></a></p><blockquote name="1192" id="1192" class="graf graf--pullquote graf-after--p">NTLM Authentication is a challenge-response based protocol. Challenge-response protocols use a commonly shared secret, in this case the user password, to authenticate the client. The server sends a challenge, and the client replies with the response on this challenge. If the challenge matches the one calculated by the server, the authentication is accepted. The NTLM Authentication is a complex protocol, and how it is explained here is a simplification. A very good and detailed description can be found at <a href="http://davenport.sourceforge.net/ntlm.html" data-href="http://davenport.sourceforge.net/ntlm.html" class="markup--anchor markup--pullquote-anchor" rel="nofollow noopener" target="_blank">http://davenport.sourceforge.net/ntlm.html</a></blockquote><figure name="1641" id="1641" class="graf graf--figure graf-after--pullquote"><div class="aspectRatioPlaceholder is-locked" style="max-width: 362px; max-height: 80px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 22.1%;"></div><img class="graf-image" data-image-id="1*MeIC7wR1YNcKcDwBIyPCkg.png" data-width="362" data-height="80" src="https://cdn-images-1.medium.com/max/1600/1*MeIC7wR1YNcKcDwBIyPCkg.png"></div><figcaption class="imageCaption">ntmlreayx and a randomized selection of targets</figcaption></figure><p name="8604" id="8604" class="graf graf--p graf-after--figure">Both SMBRelay and the newer attacks take advantage of Windows computers who don’t enforce SMB signing, allowing a privileged user to authenticate via SMB/NTLM authentication mechanisms.</p><ul class="postList"><li name="9abe" id="9abe" class="graf graf--li graf-after--p">It’s important to note that the targets file contained a list of Windows hosts on different networks. A nice trick of mine is to create your target lists of non smb signed hosts in a randomized fashion</li><li name="a81c" id="a81c" class="graf graf--li graf-after--li">The host list which expedited me getting domain admin allowed Domain Users local admin access to a SQL server that shared the same local admin password with a Domain controller</li></ul><h4 name="c9d9" id="c9d9" class="graf graf--h4 graf-after--li">By default ntlmrealyx runs secretsdumps if you do not specify a binary to execute.</h4><figure name="48fc" id="48fc" class="graf graf--figure graf-after--h4"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 83px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 11.899999999999999%;"></div><img class="graf-image" data-image-id="1*pOO-cX5cNUfEn1o32-SFPA.png" data-width="2739" data-height="325" data-action="zoom" data-action-value="1*pOO-cX5cNUfEn1o32-SFPA.png" src="https://cdn-images-1.medium.com/max/1600/1*pOO-cX5cNUfEn1o32-SFPA.png"></div><figcaption class="imageCaption">Administrator hash</figcaption></figure><p name="f9a6" id="f9a6" class="graf graf--p graf-after--figure">After a successful NTLM Relay you’ll find the file with hashes named “IP_samhashes” in the directory where you executed ntmrelayx.</p><p name="0e8c" id="0e8c" class="graf graf--p graf-after--p">Using this administrator hash, I obtained DA with the infamous <a href="https://www.sans.org/reading-room/whitepapers/testing/pass-the-hash-attacks-tools-mitigation-33283" data-href="https://www.sans.org/reading-room/whitepapers/testing/pass-the-hash-attacks-tools-mitigation-33283" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">pass-the-hash </a>technique’ using impacket’s wmiexec.py</p><figure name="0dad" id="0dad" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 81px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 11.600000000000001%;"></div><img class="graf-image" data-image-id="1*dukE-2XCk_6I9FGb98sfmQ.png" data-width="2828" data-height="329" data-action="zoom" data-action-value="1*dukE-2XCk_6I9FGb98sfmQ.png" src="https://cdn-images-1.medium.com/max/1600/1*dukE-2XCk_6I9FGb98sfmQ.png"></div><figcaption class="imageCaption">Shell access to the Domain Controller</figcaption></figure><figure name="f890" id="f890" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 479px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 68.5%;"></div><img class="graf-image" data-image-id="1*vnEng8O4sGJ1DENY2SmiqA.png" data-width="2139" data-height="1465" data-is-featured="true" data-action="zoom" data-action-value="1*vnEng8O4sGJ1DENY2SmiqA.png" src="https://cdn-images-1.medium.com/max/1600/1*vnEng8O4sGJ1DENY2SmiqA.png"></div><figcaption class="imageCaption">mitm6 + ntlmrelayx + pth = Domain ADmin</figcaption></figure><p name="0f4c" id="0f4c" class="graf graf--p graf-after--figure">In the scenario above, I was able to relay credentials from one network to another and recover an administrator hash that could be passed with <a href="https://github.com/CoreSecurity/impacket/blob/master/examples/wmiexec.py" data-href="https://github.com/CoreSecurity/impacket/blob/master/examples/wmiexec.py" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">wmiexec.py. </a>This particular local administrator hash allowed me to gain Domain administrator without cracking a password, or even having a valid Domain user account beforehand.</p><p name="f67f" id="f67f" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">3. </strong><a href="https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS17-010/ms17_010_eternalblue.rb" data-href="https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS17-010/ms17_010_eternalblue.rb" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><strong class="markup--strong markup--p-strong">MS17–010</strong></a></p><p name="e82f" id="e82f" class="graf graf--p graf-after--p"><a href="https://isc.sans.edu/forums/diary/Using+nmap+to+scan+for+MS17010+CVE20170143+EternalBlue/22574/" data-href="https://isc.sans.edu/forums/diary/Using+nmap+to+scan+for+MS17010+CVE20170143+EternalBlue/22574/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><strong class="markup--strong markup--p-strong">nmap -Pn -p445 — open — max-hostgroup 3 — script smb-vuln-ms17–010 &lt;ip_netblock&gt;</strong></a></p><blockquote name="b1e8" id="b1e8" class="graf graf--pullquote graf-after--p">ETERNALBLUE, ETERNALCHAMPION, ETERNALROMANCE, and ETERNALSYNERGY are four of multiple Equation Group vulnerabilities and exploits disclosed on 2017/04/14 by a group known as the Shadow Brokers. WannaCry / WannaCrypt is a ransomware program utilizing the ETERNALBLUE exploit, and EternalRocks is a worm that utilizes seven Equation Group vulnerabilities. Petya is a ransomware program that first utilizes CVE-2017–0199, a vulnerability in Microsoft Office, and then spreads via ETERNALBLUE.</blockquote><figure name="a587" id="a587" class="graf graf--figure graf-after--pullquote"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 371px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 53%;"></div><img class="graf-image" data-image-id="1*Nh7ufmdlWuyz1A6uOQvgSg.png" data-width="1145" data-height="607" data-action="zoom" data-action-value="1*Nh7ufmdlWuyz1A6uOQvgSg.png" src="https://cdn-images-1.medium.com/max/1600/1*Nh7ufmdlWuyz1A6uOQvgSg.png"></div><figcaption class="imageCaption">2018’s “8067”</figcaption></figure><p name="bcee" id="bcee" class="graf graf--p graf-after--figure">4. <a href="https://www.blackhillsinfosec.com/a-toast-to-kerberoast/" data-href="https://www.blackhillsinfosec.com/a-toast-to-kerberoast/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><strong class="markup--strong markup--p-strong">Kerberoasting</strong></a></p><blockquote name="9e11" id="9e11" class="graf graf--pullquote graf-after--p">Recently I have had a lot of success with privilege escalation in an Active Directory domain environment using an attack called Kerberoasting. <a href="https://twitter.com/TimMedin" data-href="https://twitter.com/TimMedin" class="markup--anchor markup--pullquote-anchor" rel="nofollow noopener" target="_blank">Tim Medin</a> presented this technique at <a href="https://files.sans.org/summit/hackfest2014/PDFs/Kicking%20the%20Guard%20Dog%20of%20Hades%20-%20Attacking%20Microsoft%20Kerberos%20-%20Tim%20Medin%281%29.pdf" data-href="https://files.sans.org/summit/hackfest2014/PDFs/Kicking%20the%20Guard%20Dog%20of%20Hades%20-%20Attacking%20Microsoft%20Kerberos%20-%20Tim%20Medin(1).pdf" class="markup--anchor markup--pullquote-anchor" rel="nofollow noopener" target="_blank">SANS Hackfest 2014</a> and since then there have been numerous awesome articles and conference talks on the details of the attack and tools written for different techniques to pull it off (reference links at the bottom of the post).</blockquote><blockquote name="9be2" id="9be2" class="graf graf--pullquote graf-after--pullquote">The Microsoft implementation of Kerberos can be a bit complicated, but the gist of the attack is that it takes advantage of legacy Active Directory support for older Windows clients and the type of encryption used and the key material used to encrypt and sign Kerberos tickets. Essentially, when a domain account is configured to run a service in the environment, such as MS SQL, a Service Principal Name (SPN) is used in the domain to associate the service with a login account. When a user wishes to use the specific resource they receive a Kerberos ticket signed with NTLM hash of the account that is running the service</blockquote><p name="ee51" id="ee51" class="graf graf--p graf-after--pullquote">Example below from <a href="https://room362.com/post/2016/kerberoast-pt1/" data-href="https://room362.com/post/2016/kerberoast-pt1/" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">mubix’s site</a></p><pre name="0b26" id="0b26" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">root@wpad:~/impacket/examples# ./GetUserSPNs.py -dc-ip 192.168.168.10 sittingduck.info/notanadmin<br>Impacket v0.9.15-dev - Copyright 2002-2016 Core Security Technologies<br><br>Password:<br>ServicePrincipalName                Name        MemberOf                                          PasswordLastSet<br>----------------------------------  ----------  ------------------------------------------------  -------------------<br>http/win10.sittingduck.info         uberuser    CN=Domain Admins,CN=Users,DC=sittingduck,DC=info  2015-11-10 23:47:21<br>MSSQLSvc/WIN2K8R2.sittingduck.info  sqladmin01                                                    2016-05-13 19:13:20</code></pre><p name="760a" id="760a" class="graf graf--p graf-after--pre">5. <strong class="markup--strong markup--p-strong">mitm6</strong></p><p name="b2e8" id="b2e8" class="graf graf--p graf-after--p">Mitm6 is an incredibly powerful tool for obtaining and escalating privileges on a your typical Windows broadcast network. When other attacks above fail on their own; try chaining smbrelay + mitm6 or it’s default counterpart ntlmreayx. Use your imagination, and harness the power of mitm6 to gain DA before lunch!</p><figure name="be9b" id="be9b" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 251px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 35.9%;"></div><img class="graf-image" data-image-id="1*puHYIgmUcLKQerVLjPTJeg.png" data-width="1684" data-height="605" data-action="zoom" data-action-value="1*puHYIgmUcLKQerVLjPTJeg.png" src="https://cdn-images-1.medium.com/max/1600/1*puHYIgmUcLKQerVLjPTJeg.png"></div><figcaption class="imageCaption">mitm6 spoofing</figcaption></figure><p name="7eeb" id="7eeb" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Usage with ntlmrelayx:</strong></p><blockquote name="2d1e" id="2d1e" class="graf graf--pullquote graf-after--p">mitm6 is designed to be used with ntlmrelayx. You should run the tools next to each other, in this scenario mitm6 will spoof the DNS, causing victims to connect to ntlmrelayx for HTTP and SMB connections. For this you have to make sure to run ntlmrelayx with the <code class="markup--code markup--pullquote-code">-6</code> option, which will make it listen on both IPv4 and IPv6. To obtain credentials for WPAD, specify the WPAD hostname to spoof with <code class="markup--code markup--pullquote-code">-wh HOSTNAME</code> (any non-existing hostname in the local domain will work since mitm6 is the DNS server). Optionally you can also use the <code class="markup--code markup--pullquote-code">-wa N</code> parameter with a number of attempts to prompt for authentication for the WPAD file itself in case you suspect victims do not have the MS16-077 patch applied.</blockquote><blockquote name="c963" id="c963" class="graf graf--pullquote graf-after--pullquote">mitm6 is a pentesting tool that exploits the default configuration of Windows to take over the default DNS server. It does this by replying to DHCPv6 messages, providing victims with a link-local IPv6 address and setting the attackers host as default DNS server. As DNS server, mitm6 will selectively reply to DNS queries of the attackers choosing and redirect the victims traffic to the attacker machine instead of the legitimate server. For a full explanation of the attack, see our <a href="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/" data-href="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/" class="markup--anchor markup--pullquote-anchor" rel="nofollow noopener" target="_blank">blog about mitm6</a>. Mitm6 is designed to work together with <a href="https://github.com/CoreSecurity/impacket" data-href="https://github.com/CoreSecurity/impacket" class="markup--anchor markup--pullquote-anchor" rel="nofollow noopener" target="_blank">ntlmrelayx from impacket</a> for WPAD spoofing and credential relaying.</blockquote><blockquote name="e205" id="e205" class="graf graf--blockquote graf--hasDropCapModel graf-after--pullquote">Reference below: Many parts of this blog are directly cited and copied from the sources below. All credit goes to those, whose amazing work I have either cited or used for obtaining Domain Admin in the realz.</blockquote><p name="8aa3" id="8aa3" class="graf graf--p graf-after--blockquote"><em class="markup--em markup--p-em">Hack all things and be responsible!!!</em></p><div name="4ab3" id="4ab3" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://1337red.wordpress.com/using-a-scf-file-to-gather-hashes/" data-href="https://1337red.wordpress.com/using-a-scf-file-to-gather-hashes/" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://1337red.wordpress.com/using-a-scf-file-to-gather-hashes/" rel="nofollow"><strong class="markup--strong markup--mixtapeEmbed-strong">Using a SCF file to Gather Hashes</strong><br><em class="markup--em markup--mixtapeEmbed-em">Have you ever been on a internal network assessment and discovered an unauthenticated writable Windows-based file…</em>1337red.wordpress.com</a><a href="https://1337red.wordpress.com/using-a-scf-file-to-gather-hashes/" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="227de21a2802978d75b62f05de8e4049" data-thumbnail-img-id="0*o0gpgyik2TPYQ3BA." style="background-image: url(https://cdn-images-1.medium.com/fit/c/320/320/0*o0gpgyik2TPYQ3BA.);"></a></div><div name="11be" id="11be" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://github.com/lgandx/Responder" data-href="https://github.com/lgandx/Responder" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/lgandx/Responder" rel="nofollow"><strong class="markup--strong markup--mixtapeEmbed-strong">lgandx/Responder</strong><br><em class="markup--em markup--mixtapeEmbed-em">Responder is a LLMNR, NBT-NS and MDNS poisoner, with built-in HTTP/SMB/MSSQL/FTP/LDAP rogue authentication server…</em>github.com</a><a href="https://github.com/lgandx/Responder" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="213537811f3639a23f7a27d5bd64bf08" data-thumbnail-img-id="0*kmiBWDUnx9qVPwAa." style="background-image: url(https://cdn-images-1.medium.com/fit/c/320/320/0*kmiBWDUnx9qVPwAa.);"></a></div><div name="6da7" id="6da7" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://github.com/Kevin-Robertson/Inveigh" data-href="https://github.com/Kevin-Robertson/Inveigh" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/Kevin-Robertson/Inveigh" rel="nofollow"><strong class="markup--strong markup--mixtapeEmbed-strong">Kevin-Robertson/Inveigh</strong><br><em class="markup--em markup--mixtapeEmbed-em">Inveigh is a Windows PowerShell LLMNR/mDNS/NBNS spoofer/man-in-the-middle tool</em>github.com</a><a href="https://github.com/Kevin-Robertson/Inveigh" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="2fa28ae4b0f16210c33cb4312ffc3d05" data-thumbnail-img-id="0*uOi3jTh9TawFR_2H." style="background-image: url(https://cdn-images-1.medium.com/fit/c/320/320/0*uOi3jTh9TawFR_2H.);"></a></div><div name="18d5" id="18d5" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://github.com/purpleteam/snarf" data-href="https://github.com/purpleteam/snarf" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/purpleteam/snarf" rel="nofollow"><strong class="markup--strong markup--mixtapeEmbed-strong">purpleteam/snarf</strong><br><em class="markup--em markup--mixtapeEmbed-em">snarf - Snarf man-in-the-middle / relay suite</em>github.com</a><a href="https://github.com/purpleteam/snarf" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="7dbc9d555c2622d36057e1dd9b42e36e" data-thumbnail-img-id="0*0yMkSOrEI6Zz7cV7." style="background-image: url(https://cdn-images-1.medium.com/fit/c/320/320/0*0yMkSOrEI6Zz7cV7.);"></a></div><div name="1ed9" id="1ed9" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://github.com/fox-it/mitm6" data-href="https://github.com/fox-it/mitm6" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/fox-it/mitm6" rel="nofollow"><strong class="markup--strong markup--mixtapeEmbed-strong">fox-it/mitm6</strong><br><em class="markup--em markup--mixtapeEmbed-em">mitm6 - pwning IPv4 via IPv6</em>github.com</a><a href="https://github.com/fox-it/mitm6" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="37097e779800eecdf3e9c0cb267bd240" data-thumbnail-img-id="0*pzfIiIOxtT_66XzQ." style="background-image: url(https://cdn-images-1.medium.com/fit/c/320/320/0*pzfIiIOxtT_66XzQ.);"></a></div><div name="4c3a" id="4c3a" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://www.blackhillsinfosec.com/a-toast-to-kerberoast/" data-href="https://www.blackhillsinfosec.com/a-toast-to-kerberoast/" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://www.blackhillsinfosec.com/a-toast-to-kerberoast/" rel="nofollow"><strong class="markup--strong markup--mixtapeEmbed-strong">A Toast to Kerberoast - Black Hills Information Security</strong><br><em class="markup--em markup--mixtapeEmbed-em">Derek Banks // This post will walk through a technique to remotely run a Kerberoast attack over an established…</em>www.blackhillsinfosec.com</a><a href="https://www.blackhillsinfosec.com/a-toast-to-kerberoast/" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="ad83e7dfbd9b352bb36b8c20041107a3" data-thumbnail-img-id="0*4q4RAgXPkDR51RSN." style="background-image: url(https://cdn-images-1.medium.com/fit/c/320/320/0*4q4RAgXPkDR51RSN.);"></a></div><div name="0253" id="0253" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://www.fox-it.com/en/insights/blogs/blog/inside-windows-network/" data-href="https://www.fox-it.com/en/insights/blogs/blog/inside-windows-network/" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://www.fox-it.com/en/insights/blogs/blog/inside-windows-network/" rel="nofollow"><strong class="markup--strong markup--mixtapeEmbed-strong">Common weaknesses in your Windows network - Fox-IT (ENG)</strong><br><em class="markup--em markup--mixtapeEmbed-em">At Fox-IT we are committed to making our clients aware of common security risks in their organizations. Credential…</em>www.fox-it.com</a><a href="https://www.fox-it.com/en/insights/blogs/blog/inside-windows-network/" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="2b5a7b39281449caa674957e851b37ee" data-thumbnail-img-id="0*HFnrLRfoH2A6_Xws." style="background-image: url(https://cdn-images-1.medium.com/fit/c/320/320/0*HFnrLRfoH2A6_Xws.);"></a></div><div name="6fbe" id="6fbe" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS17-010/ms17_010_eternalblue.rb" data-href="https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS17-010/ms17_010_eternalblue.rb" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS17-010/ms17_010_eternalblue.rb" rel="nofollow"><strong class="markup--strong markup--mixtapeEmbed-strong">SecWiki/windows-kernel-exploits</strong><br><em class="markup--em markup--mixtapeEmbed-em">windows-kernel-exploits Windows平台提权漏洞集合</em>github.com</a><a href="https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS17-010/ms17_010_eternalblue.rb" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="88ec04a3d2fc3e79e4c1950699669c6e" data-thumbnail-img-id="0*AR-Ngh4J41G004Cu." style="background-image: url(https://cdn-images-1.medium.com/fit/c/320/320/0*AR-Ngh4J41G004Cu.);"></a></div><div name="fbd8" id="fbd8" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://room362.com/post/2016/kerberoast-pt1/" data-href="https://room362.com/post/2016/kerberoast-pt1/" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://room362.com/post/2016/kerberoast-pt1/" rel="nofollow"><strong class="markup--strong markup--mixtapeEmbed-strong">Kerberoasting - Part 1</strong><br><em class="markup--em markup--mixtapeEmbed-em">Previous works: There has been a number of differnet blog posts, presentations and projects that have happened before…</em>room362.com</a><a href="https://room362.com/post/2016/kerberoast-pt1/" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="f652be17729ecccddf3af5ade99a9b71"></a></div><p name="745b" id="745b" class="graf graf--p graf-after--mixtapeEmbed graf--trailing"><a href="https://isc.sans.edu/forums/diary/Using+nmap+to+scan+for+MS17010+CVE20170143+EternalBlue/22574" data-href="https://isc.sans.edu/forums/diary/Using+nmap+to+scan+for+MS17010+CVE20170143+EternalBlue/22574" class="markup--anchor markup--p-anchor" rel="nofollow noopener nofollow noopener" target="_blank">https://isc.sans.edu/forums/diary/Using+nmap+to+scan+for+MS17010+CVE20170143+EternalBlue/22574</a></p></div></div></section></div><footer class="u-paddingTop10"><div class="container u-maxWidth740"><div class="row"><div class="col u-size12of12"></div></div><div class="row"><div class="col u-size12of12 js-postTags"><div class="u-paddingBottom10"><ul class="tags tags--postTags tags--borderless"><li><a class="link u-baseColor--link"   href="https://medium.com/tag/penetration-testing?source=post" data-action-source="post">Penetration Testing</a></li><li><a class="link u-baseColor--link"   href="https://medium.com/tag/security?source=post" data-action-source="post">Security</a></li><li><a class="link u-baseColor--link"   href="https://medium.com/tag/cybersecurity?source=post" data-action-source="post">Cybersecurity</a></li><li><a class="link u-baseColor--link"   href="https://medium.com/tag/hacking?source=post" data-action-source="post">Hacking</a></li></ul></div></div></div><section class="uiScale uiScale-ui--small uiScale-caption--regular u-borderTopLightest u-marginTop10 u-paddingTop20"><div class="ui-h3 u-textColorDarker u-fontSize22">One clap, two clap, three clap, forty?</div><p class="ui-body u-marginBottom20 u-textColorDark u-fontSize16">By clapping more or less, you can signal to us which stories really stand out.</p></section><div class="postActions js-postActionsFooter"><div class="u-flexCenter"><div class="u-flex1"><div class="multirecommend js-actionMultirecommend u-flexCenter u-width60" data-post-id="82259ab73aaa" data-is-icon-29px="true" data-is-circle="true" data-has-recommend-list="true" data-source="post_actions_footer-----82259ab73aaa---------------------clap_footer"><div class="u-relative u-foreground"><button class="button button--large button--circle button--withChrome u-baseColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--largePill u-relative u-foreground u-xs-paddingLeft13 u-width60 u-height60 u-accentColor--textNormal u-accentColor--buttonNormal clap-onboarding"  data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/82259ab73aaa" data-action-source="post_actions_footer-----82259ab73aaa---------------------clap_footer" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" viewBox="0 0 33 33" ><path d="M28.86 17.342l-3.64-6.402c-.292-.433-.712-.729-1.163-.8a1.124 1.124 0 0 0-.889.213c-.63.488-.742 1.181-.33 2.061l1.222 2.587 1.4 2.46c2.234 4.085 1.511 8.007-2.145 11.663-.26.26-.526.49-.797.707 1.42-.084 2.881-.683 4.292-2.094 3.822-3.823 3.565-7.876 2.05-10.395zm-6.252 11.075c3.352-3.35 3.998-6.775 1.978-10.469l-3.378-5.945c-.292-.432-.712-.728-1.163-.8a1.122 1.122 0 0 0-.89.213c-.63.49-.742 1.182-.33 2.061l1.72 3.638a.502.502 0 0 1-.806.568l-8.91-8.91a1.335 1.335 0 0 0-1.887 1.886l5.292 5.292a.5.5 0 0 1-.707.707l-5.292-5.292-1.492-1.492c-.503-.503-1.382-.505-1.887 0a1.337 1.337 0 0 0 0 1.886l1.493 1.492 5.292 5.292a.499.499 0 0 1-.353.854.5.5 0 0 1-.354-.147L5.642 13.96a1.338 1.338 0 0 0-1.887 0 1.338 1.338 0 0 0 0 1.887l2.23 2.228 3.322 3.324a.499.499 0 0 1-.353.853.502.502 0 0 1-.354-.146l-3.323-3.324a1.333 1.333 0 0 0-1.886 0 1.325 1.325 0 0 0-.39.943c0 .356.138.691.39.943l6.396 6.397c3.528 3.53 8.86 5.313 12.821 1.353zM12.73 9.26l5.68 5.68-.49-1.037c-.518-1.107-.426-2.13.224-2.89l-3.303-3.304a1.337 1.337 0 0 0-1.886 0 1.326 1.326 0 0 0-.39.944c0 .217.067.42.165.607zm14.787 19.184c-1.599 1.6-3.417 2.392-5.353 2.392-.349 0-.7-.03-1.058-.082a7.922 7.922 0 0 1-3.667.887c-3.049 0-6.115-1.626-8.359-3.87l-6.396-6.397A2.315 2.315 0 0 1 2 19.724a2.327 2.327 0 0 1 1.923-2.296l-.875-.875a2.339 2.339 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.647l-.139-.139c-.91-.91-.91-2.39 0-3.3.884-.884 2.421-.882 3.301 0l.138.14a2.335 2.335 0 0 1 3.948-1.24l.093.092c.091-.423.291-.828.62-1.157a2.336 2.336 0 0 1 3.3 0l3.384 3.386a2.167 2.167 0 0 1 1.271-.173c.534.086 1.03.354 1.441.765.11-.549.415-1.034.911-1.418a2.12 2.12 0 0 1 1.661-.41c.727.117 1.385.565 1.853 1.262l3.652 6.423c1.704 2.832 2.025 7.377-2.205 11.607zM13.217.484l-1.917.882 2.37 2.837-.454-3.719zm8.487.877l-1.928-.86-.44 3.697 2.368-2.837zM16.5 3.293L15.478-.005h2.044L16.5 3.293z" fill-rule="evenodd"/></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" viewBox="0 0 33 33" ><g fill-rule="evenodd"><path d="M29.58 17.1l-3.854-6.78c-.365-.543-.876-.899-1.431-.989a1.491 1.491 0 0 0-1.16.281c-.42.327-.65.736-.7 1.207v.001l3.623 6.367c2.46 4.498 1.67 8.802-2.333 12.807-.265.265-.536.505-.81.728 1.973-.222 3.474-1.286 4.45-2.263 4.166-4.165 3.875-8.6 2.215-11.36zm-4.831.82l-3.581-6.3c-.296-.439-.725-.742-1.183-.815a1.105 1.105 0 0 0-.89.213c-.647.502-.755 1.188-.33 2.098l1.825 3.858a.601.601 0 0 1-.197.747.596.596 0 0 1-.77-.067L10.178 8.21c-.508-.506-1.393-.506-1.901 0a1.335 1.335 0 0 0-.393.95c0 .36.139.698.393.95v.001l5.61 5.61a.599.599 0 1 1-.848.847l-5.606-5.606c-.001 0-.002 0-.003-.002L5.848 9.375a1.349 1.349 0 0 0-1.902 0 1.348 1.348 0 0 0 0 1.901l1.582 1.582 5.61 5.61a.6.6 0 0 1-.848.848l-5.61-5.61c-.51-.508-1.393-.508-1.9 0a1.332 1.332 0 0 0-.394.95c0 .36.139.697.393.952l2.363 2.362c.002.001.002.002.002.003l3.52 3.52a.6.6 0 0 1-.848.847l-3.522-3.523h-.001a1.336 1.336 0 0 0-.95-.393 1.345 1.345 0 0 0-.949 2.295l6.779 6.78c3.715 3.713 9.327 5.598 13.49 1.434 3.527-3.528 4.21-7.13 2.086-11.015zM11.817 7.727c.06-.328.213-.64.466-.893.64-.64 1.755-.64 2.396 0l3.232 3.232c-.82.783-1.09 1.833-.764 2.992l-5.33-5.33z"/><path d="M13.285.48l-1.916.881 2.37 2.837z"/><path d="M21.719 1.361L19.79.501l-.44 3.697z"/><path d="M16.502 3.298L15.481 0h2.043z"/></g></svg></span></span></button><div class="clapUndo u-width60 u-round u-height32 u-absolute u-borderBox u-paddingRight5 u-transition--transform200Spring u-background--brandSageLighter js-clapUndo" style="top: 14px; padding: 2px;"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-floatRight"  data-action="multivote-undo" data-action-value="82259ab73aaa"><span class="svgIcon svgIcon--removeThin svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29" ><path d="M20.13 8.11l-5.61 5.61-5.609-5.61-.801.801 5.61 5.61-5.61 5.61.801.8 5.61-5.609 5.61 5.61.8-.801-5.609-5.61 5.61-5.61" fill-rule="evenodd"/></svg></span></button></div></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft10"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton"  data-action="show-recommends" data-action-value="82259ab73aaa">13</button></span></div></div><div class="buttonSet u-flex0"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon"  data-action="scroll-to-responses" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29" ><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"/></svg></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-hide"  title="Share on Twitter" aria-label="Share on Twitter" data-action="share-on-twitter" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--twitter svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29" ><path d="M21.967 11.8c.018 5.93-4.607 11.18-11.177 11.18-2.172 0-4.25-.62-6.047-1.76l-.268.422-.038.5.186.013.168.012c.3.02.44.032.6.046 2.06-.026 3.95-.686 5.49-1.86l1.12-.85-1.4-.048c-1.57-.055-2.92-1.08-3.36-2.51l-.48.146-.05.5c.22.03.48.05.75.08.48-.02.87-.07 1.25-.15l2.33-.49-2.32-.49c-1.68-.35-2.91-1.83-2.91-3.55 0-.05 0-.01-.01.03l-.49-.1-.25.44c.63.36 1.35.57 2.07.58l1.7.04L7.4 13c-.978-.662-1.59-1.79-1.618-3.047a4.08 4.08 0 0 1 .524-1.8l-.825.07a12.188 12.188 0 0 0 8.81 4.515l.59.033-.06-.59v-.02c-.05-.43-.06-.63-.06-.87a3.617 3.617 0 0 1 6.27-2.45l.2.21.28-.06c1.01-.22 1.94-.59 2.73-1.09l-.75-.56c-.1.36-.04.89.12 1.36.23.68.58 1.13 1.17.85l-.21-.45-.42-.27c-.52.8-1.17 1.48-1.92 2L22 11l.016.28c.013.2.014.35 0 .52v.04zm.998.038c.018-.22.017-.417 0-.66l-.498.034.284.41a8.183 8.183 0 0 0 2.2-2.267l.97-1.48-1.6.755c.17-.08.3-.02.34.03a.914.914 0 0 1-.13-.292c-.1-.297-.13-.64-.1-.766l.36-1.254-1.1.695c-.69.438-1.51.764-2.41.963l.48.15a4.574 4.574 0 0 0-3.38-1.484 4.616 4.616 0 0 0-4.61 4.613c0 .29.02.51.08.984l.01.02.5-.06.03-.5c-3.17-.18-6.1-1.7-8.08-4.15l-.48-.56-.36.64c-.39.69-.62 1.48-.65 2.28.04 1.61.81 3.04 2.06 3.88l.3-.92c-.55-.02-1.11-.17-1.6-.45l-.59-.34-.14.67c-.02.08-.02.16 0 .24-.01 2.12 1.55 4.01 3.69 4.46l.1-.49-.1-.49c-.33.07-.67.12-1.03.14-.18-.02-.43-.05-.64-.07l-.76-.09.23.73c.57 1.84 2.29 3.14 4.28 3.21l-.28-.89a8.252 8.252 0 0 1-4.85 1.66c-.12-.01-.26-.02-.56-.05l-.17-.01-.18-.01L2.53 21l1.694 1.07a12.233 12.233 0 0 0 6.58 1.917c7.156 0 12.2-5.73 12.18-12.18l-.002.04z"/></svg></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-hide"  title="Share on Facebook" aria-label="Share on Facebook" data-action="share-on-facebook" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--facebook svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29" ><path d="M16.39 23.61v-5.808h1.846a.55.55 0 0 0 .546-.48l.36-2.797a.551.551 0 0 0-.547-.62H16.39V12.67c0-.67.12-.813.828-.813h1.474a.55.55 0 0 0 .55-.55V8.803a.55.55 0 0 0-.477-.545c-.436-.06-1.36-.116-2.22-.116-2.5 0-4.13 1.62-4.13 4.248v1.513H10.56a.551.551 0 0 0-.55.55v2.797c0 .304.248.55.55.55h1.855v5.76c-4.172-.96-7.215-4.7-7.215-9.1 0-5.17 4.17-9.36 9.31-9.36 5.14 0 9.31 4.19 9.31 9.36 0 4.48-3.155 8.27-7.43 9.15M14.51 4C8.76 4 4.1 8.684 4.1 14.46c0 5.162 3.75 9.523 8.778 10.32a.55.55 0 0 0 .637-.543v-6.985a.551.551 0 0 0-.55-.55H11.11v-1.697h1.855a.55.55 0 0 0 .55-.55v-2.063c0-2.02 1.136-3.148 3.03-3.148.567 0 1.156.027 1.597.06v1.453h-.924c-1.363 0-1.93.675-1.93 1.912v1.78c0 .3.247.55.55.55h2.132l-.218 1.69H15.84c-.305 0-.55.24-.55.55v7.02c0 .33.293.59.623.54 5.135-.7 9.007-5.11 9.007-10.36C24.92 8.68 20.26 4 14.51 4"/></svg></span></button><button class="button button--large button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-show"  title="Share this story on Twitter or Facebook" aria-label="Share this story on Twitter or Facebook" data-action="show-share-popover" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--share svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29" ><path d="M20.385 8H19a.5.5 0 1 0 .011 1h1.39c.43 0 .84.168 1.14.473.31.305.48.71.48 1.142v10.77c0 .43-.17.837-.47 1.142-.3.305-.71.473-1.14.473H8.62c-.43 0-.84-.168-1.144-.473a1.603 1.603 0 0 1-.473-1.142v-10.77c0-.43.17-.837.48-1.142A1.599 1.599 0 0 1 8.62 9H10a.502.502 0 0 0 0-1H8.615c-.67 0-1.338.255-1.85.766-.51.51-.765 1.18-.765 1.85v10.77c0 .668.255 1.337.766 1.848.51.51 1.18.766 1.85.766h11.77c.668 0 1.337-.255 1.848-.766.51-.51.766-1.18.766-1.85v-10.77c0-.668-.255-1.337-.766-1.848A2.61 2.61 0 0 0 20.384 8zm-8.67-2.508L14 3.207v8.362c0 .27.224.5.5.5s.5-.23.5-.5V3.2l2.285 2.285a.49.49 0 0 0 .704-.001.511.511 0 0 0 0-.708l-3.14-3.14a.504.504 0 0 0-.71 0L11 4.776a.501.501 0 0 0 .71.706" fill-rule="evenodd"/></svg></span></button></div></div></div></div><div class="u-maxWidth740 u-paddingTop20 u-marginTop20 u-borderTopLightest container u-paddingBottom20 u-xs-paddingBottom10 js-postAttributionFooterContainer"><div class="row js-postFooterInfo"><div class="col u-size12of12"><li class="uiScale uiScale-ui--small uiScale-caption--regular u-block u-paddingBottom18 js-cardUser"><div class="u-marginLeft20 u-floatRight"><span class="followState js-followState" data-user-id="626cae9ed375"><button class="button button--small u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton"  data-action="sign-up-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-redirect="https://medium.com/@adam.toscher/top-five-ways-i-got-domain-admin-on-your-internal-network-before-lunch-2018-edition-82259ab73aaa" data-action-source="footer_card"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton"  data-action="sign-up-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/626cae9ed375" data-action-source="footer_card-626cae9ed375-------------------------follow_footer"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="u-tableCell"><a class="link u-baseColor--link avatar"   href="https://medium.com/@adam.toscher?source=footer_card" title="Go to the profile of Adam Toscher" aria-label="Go to the profile of Adam Toscher" data-action-source="footer_card" data-user-id="626cae9ed375" dir="auto"><div class="u-relative u-inlineBlock u-flex0"><img  src="https://cdn-images-1.medium.com/fit/c/120/120/0*s_J0fTAsy4Azb0dt." class="avatar-image avatar-image--small" alt="Go to the profile of Adam Toscher"><div class="avatar-halo u-absolute u-textColorGreenNormal svgIcon" style="width: calc(100% + 12px); height: calc(100% + 12px); top:-6px; left:-6px"><svg viewBox="0 0 114 114" xmlns="http://www.w3.org/2000/svg"><path d="M7.66922967,32.092726 C17.0070768,13.6353618 35.9421928,1.75 57,1.75 C78.0578072,1.75 96.9929232,13.6353618 106.33077,32.092726 L107.66923,31.4155801 C98.0784505,12.4582656 78.6289015,0.25 57,0.25 C35.3710985,0.25 15.9215495,12.4582656 6.33077033,31.4155801 L7.66922967,32.092726 Z"></path><path d="M106.33077,81.661427 C96.9929232,100.118791 78.0578072,112.004153 57,112.004153 C35.9421928,112.004153 17.0070768,100.118791 7.66922967,81.661427 L6.33077033,82.338573 C15.9215495,101.295887 35.3710985,113.504153 57,113.504153 C78.6289015,113.504153 98.0784505,101.295887 107.66923,82.338573 L106.33077,81.661427 Z"></path></svg></div></div></a></div><div class="u-tableCell u-verticalAlignMiddle u-breakWord u-paddingLeft15"><h3 class="ui-h3 u-fontSize18 u-lineHeightTighter"><a class="link link--primary u-accentColor--hoverTextNormal"   href="https://medium.com/@adam.toscher" property="cc:attributionName" title="Go to the profile of Adam Toscher" aria-label="Go to the profile of Adam Toscher" rel="author cc:attributionUrl" data-user-id="626cae9ed375" dir="auto">Adam Toscher</a></h3><div class="ui-caption u-textColorGreenNormal u-fontSize13 u-tintSpectrum u-accentColor--textNormal u-marginBottom7">Medium member since Oct 2017</div><p class="ui-body u-fontSize14 u-lineHeightBaseSans u-textColorDark u-marginBottom4">Adam is an independent penetration tester who has over 20 years of experience in the technology industry.</p></div></li></div></div></div><div class="js-postFooterPlacements"></div><div class="u-padding0 u-clearfix u-backgroundGrayLightest u-print-hide supplementalPostContent js-responsesWrapper"></div><div class="supplementalPostContent js-heroPromo"></div></footer></article></main><div class="u-marginAuto u-maxWidth1000"><div class="js-postShareWidget u-foreground u-sm-hide u-transition--fadeOut300 u-fixed"><ul><li class="u-textAlignCenter u-marginVertical10"><div class="multirecommend js-actionMultirecommend u-flexColumn u-marginBottom10 u-width60" data-post-id="82259ab73aaa" data-is-icon-29px="true" data-is-vertical="true" data-is-circle="true" data-has-recommend-list="true" data-source="post_share_widget-----82259ab73aaa---------------------clap_sidebar"><div class="u-relative u-foreground"><button class="button button--large button--circle button--withChrome u-baseColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--largePill u-relative u-foreground u-xs-paddingLeft13 u-width60 u-height60 u-accentColor--textNormal u-accentColor--buttonNormal"  data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/82259ab73aaa" data-action-source="post_share_widget-----82259ab73aaa---------------------clap_sidebar" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" viewBox="0 0 33 33" ><path d="M28.86 17.342l-3.64-6.402c-.292-.433-.712-.729-1.163-.8a1.124 1.124 0 0 0-.889.213c-.63.488-.742 1.181-.33 2.061l1.222 2.587 1.4 2.46c2.234 4.085 1.511 8.007-2.145 11.663-.26.26-.526.49-.797.707 1.42-.084 2.881-.683 4.292-2.094 3.822-3.823 3.565-7.876 2.05-10.395zm-6.252 11.075c3.352-3.35 3.998-6.775 1.978-10.469l-3.378-5.945c-.292-.432-.712-.728-1.163-.8a1.122 1.122 0 0 0-.89.213c-.63.49-.742 1.182-.33 2.061l1.72 3.638a.502.502 0 0 1-.806.568l-8.91-8.91a1.335 1.335 0 0 0-1.887 1.886l5.292 5.292a.5.5 0 0 1-.707.707l-5.292-5.292-1.492-1.492c-.503-.503-1.382-.505-1.887 0a1.337 1.337 0 0 0 0 1.886l1.493 1.492 5.292 5.292a.499.499 0 0 1-.353.854.5.5 0 0 1-.354-.147L5.642 13.96a1.338 1.338 0 0 0-1.887 0 1.338 1.338 0 0 0 0 1.887l2.23 2.228 3.322 3.324a.499.499 0 0 1-.353.853.502.502 0 0 1-.354-.146l-3.323-3.324a1.333 1.333 0 0 0-1.886 0 1.325 1.325 0 0 0-.39.943c0 .356.138.691.39.943l6.396 6.397c3.528 3.53 8.86 5.313 12.821 1.353zM12.73 9.26l5.68 5.68-.49-1.037c-.518-1.107-.426-2.13.224-2.89l-3.303-3.304a1.337 1.337 0 0 0-1.886 0 1.326 1.326 0 0 0-.39.944c0 .217.067.42.165.607zm14.787 19.184c-1.599 1.6-3.417 2.392-5.353 2.392-.349 0-.7-.03-1.058-.082a7.922 7.922 0 0 1-3.667.887c-3.049 0-6.115-1.626-8.359-3.87l-6.396-6.397A2.315 2.315 0 0 1 2 19.724a2.327 2.327 0 0 1 1.923-2.296l-.875-.875a2.339 2.339 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.647l-.139-.139c-.91-.91-.91-2.39 0-3.3.884-.884 2.421-.882 3.301 0l.138.14a2.335 2.335 0 0 1 3.948-1.24l.093.092c.091-.423.291-.828.62-1.157a2.336 2.336 0 0 1 3.3 0l3.384 3.386a2.167 2.167 0 0 1 1.271-.173c.534.086 1.03.354 1.441.765.11-.549.415-1.034.911-1.418a2.12 2.12 0 0 1 1.661-.41c.727.117 1.385.565 1.853 1.262l3.652 6.423c1.704 2.832 2.025 7.377-2.205 11.607zM13.217.484l-1.917.882 2.37 2.837-.454-3.719zm8.487.877l-1.928-.86-.44 3.697 2.368-2.837zM16.5 3.293L15.478-.005h2.044L16.5 3.293z" fill-rule="evenodd"/></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" viewBox="0 0 33 33" ><g fill-rule="evenodd"><path d="M29.58 17.1l-3.854-6.78c-.365-.543-.876-.899-1.431-.989a1.491 1.491 0 0 0-1.16.281c-.42.327-.65.736-.7 1.207v.001l3.623 6.367c2.46 4.498 1.67 8.802-2.333 12.807-.265.265-.536.505-.81.728 1.973-.222 3.474-1.286 4.45-2.263 4.166-4.165 3.875-8.6 2.215-11.36zm-4.831.82l-3.581-6.3c-.296-.439-.725-.742-1.183-.815a1.105 1.105 0 0 0-.89.213c-.647.502-.755 1.188-.33 2.098l1.825 3.858a.601.601 0 0 1-.197.747.596.596 0 0 1-.77-.067L10.178 8.21c-.508-.506-1.393-.506-1.901 0a1.335 1.335 0 0 0-.393.95c0 .36.139.698.393.95v.001l5.61 5.61a.599.599 0 1 1-.848.847l-5.606-5.606c-.001 0-.002 0-.003-.002L5.848 9.375a1.349 1.349 0 0 0-1.902 0 1.348 1.348 0 0 0 0 1.901l1.582 1.582 5.61 5.61a.6.6 0 0 1-.848.848l-5.61-5.61c-.51-.508-1.393-.508-1.9 0a1.332 1.332 0 0 0-.394.95c0 .36.139.697.393.952l2.363 2.362c.002.001.002.002.002.003l3.52 3.52a.6.6 0 0 1-.848.847l-3.522-3.523h-.001a1.336 1.336 0 0 0-.95-.393 1.345 1.345 0 0 0-.949 2.295l6.779 6.78c3.715 3.713 9.327 5.598 13.49 1.434 3.527-3.528 4.21-7.13 2.086-11.015zM11.817 7.727c.06-.328.213-.64.466-.893.64-.64 1.755-.64 2.396 0l3.232 3.232c-.82.783-1.09 1.833-.764 2.992l-5.33-5.33z"/><path d="M13.285.48l-1.916.881 2.37 2.837z"/><path d="M21.719 1.361L19.79.501l-.44 3.697z"/><path d="M16.502 3.298L15.481 0h2.043z"/></g></svg></span></span></button><div class="clapUndo u-width60 u-round u-height32 u-absolute u-borderBox u-paddingRight5 u-transition--transform200Spring u-background--brandSageLighter js-clapUndo" style="top: 14px; padding: 2px;"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-floatRight"  data-action="multivote-undo" data-action-value="82259ab73aaa"><span class="svgIcon svgIcon--removeThin svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29" ><path d="M20.13 8.11l-5.61 5.61-5.609-5.61-.801.801 5.61 5.61-5.61 5.61.801.8 5.61-5.609 5.61 5.61.8-.801-5.609-5.61 5.61-5.61" fill-rule="evenodd"/></svg></span></button></div></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-flexOrderNegative1 u-height20 u-marginBottom7"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-block u-marginAuto"  data-action="show-recommends" data-action-value="82259ab73aaa">13</button></span></div></li><li class="u-textAlignCenter u-marginVertical10"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon"  title="Share on Twitter" aria-label="Share on Twitter" data-action="share-on-twitter" data-action-source="post_share_widget"><span class="svgIcon svgIcon--twitter svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29" ><path d="M21.967 11.8c.018 5.93-4.607 11.18-11.177 11.18-2.172 0-4.25-.62-6.047-1.76l-.268.422-.038.5.186.013.168.012c.3.02.44.032.6.046 2.06-.026 3.95-.686 5.49-1.86l1.12-.85-1.4-.048c-1.57-.055-2.92-1.08-3.36-2.51l-.48.146-.05.5c.22.03.48.05.75.08.48-.02.87-.07 1.25-.15l2.33-.49-2.32-.49c-1.68-.35-2.91-1.83-2.91-3.55 0-.05 0-.01-.01.03l-.49-.1-.25.44c.63.36 1.35.57 2.07.58l1.7.04L7.4 13c-.978-.662-1.59-1.79-1.618-3.047a4.08 4.08 0 0 1 .524-1.8l-.825.07a12.188 12.188 0 0 0 8.81 4.515l.59.033-.06-.59v-.02c-.05-.43-.06-.63-.06-.87a3.617 3.617 0 0 1 6.27-2.45l.2.21.28-.06c1.01-.22 1.94-.59 2.73-1.09l-.75-.56c-.1.36-.04.89.12 1.36.23.68.58 1.13 1.17.85l-.21-.45-.42-.27c-.52.8-1.17 1.48-1.92 2L22 11l.016.28c.013.2.014.35 0 .52v.04zm.998.038c.018-.22.017-.417 0-.66l-.498.034.284.41a8.183 8.183 0 0 0 2.2-2.267l.97-1.48-1.6.755c.17-.08.3-.02.34.03a.914.914 0 0 1-.13-.292c-.1-.297-.13-.64-.1-.766l.36-1.254-1.1.695c-.69.438-1.51.764-2.41.963l.48.15a4.574 4.574 0 0 0-3.38-1.484 4.616 4.616 0 0 0-4.61 4.613c0 .29.02.51.08.984l.01.02.5-.06.03-.5c-3.17-.18-6.1-1.7-8.08-4.15l-.48-.56-.36.64c-.39.69-.62 1.48-.65 2.28.04 1.61.81 3.04 2.06 3.88l.3-.92c-.55-.02-1.11-.17-1.6-.45l-.59-.34-.14.67c-.02.08-.02.16 0 .24-.01 2.12 1.55 4.01 3.69 4.46l.1-.49-.1-.49c-.33.07-.67.12-1.03.14-.18-.02-.43-.05-.64-.07l-.76-.09.23.73c.57 1.84 2.29 3.14 4.28 3.21l-.28-.89a8.252 8.252 0 0 1-4.85 1.66c-.12-.01-.26-.02-.56-.05l-.17-.01-.18-.01L2.53 21l1.694 1.07a12.233 12.233 0 0 0 6.58 1.917c7.156 0 12.2-5.73 12.18-12.18l-.002.04z"/></svg></span></button></li><li class="u-textAlignCenter u-marginVertical10"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon"  title="Share on Facebook" aria-label="Share on Facebook" data-action="share-on-facebook" data-action-source="post_share_widget"><span class="svgIcon svgIcon--facebook svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29" ><path d="M16.39 23.61v-5.808h1.846a.55.55 0 0 0 .546-.48l.36-2.797a.551.551 0 0 0-.547-.62H16.39V12.67c0-.67.12-.813.828-.813h1.474a.55.55 0 0 0 .55-.55V8.803a.55.55 0 0 0-.477-.545c-.436-.06-1.36-.116-2.22-.116-2.5 0-4.13 1.62-4.13 4.248v1.513H10.56a.551.551 0 0 0-.55.55v2.797c0 .304.248.55.55.55h1.855v5.76c-4.172-.96-7.215-4.7-7.215-9.1 0-5.17 4.17-9.36 9.31-9.36 5.14 0 9.31 4.19 9.31 9.36 0 4.48-3.155 8.27-7.43 9.15M14.51 4C8.76 4 4.1 8.684 4.1 14.46c0 5.162 3.75 9.523 8.778 10.32a.55.55 0 0 0 .637-.543v-6.985a.551.551 0 0 0-.55-.55H11.11v-1.697h1.855a.55.55 0 0 0 .55-.55v-2.063c0-2.02 1.136-3.148 3.03-3.148.567 0 1.156.027 1.597.06v1.453h-.924c-1.363 0-1.93.675-1.93 1.912v1.78c0 .3.247.55.55.55h2.132l-.218 1.69H15.84c-.305 0-.55.24-.55.55v7.02c0 .33.293.59.623.54 5.135-.7 9.007-5.11 9.007-10.36C24.92 8.68 20.26 4 14.51 4"/></svg></span></button></li><li class="u-textAlignCenter u-marginVertical10"><button class="button button--large button--dark button--chromeless is-touchIconFadeInPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton"  title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-up-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/82259ab73aaa" data-action-source="post_share_widget-----82259ab73aaa---------------------bookmark_sidebar"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29" ><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z" fill-rule="evenodd"/></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29" ><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z" fill-rule="evenodd"/></svg></span></span></button></li></ul></div></div><div class="u-fixed u-bottom0 u-sizeFullWidth u-backgroundWhite u-boxShadowTop u-borderBox u-paddingTop10 u-paddingBottom10 u-zIndexMetabar u-xs-paddingLeft10 u-xs-paddingRight10 js-stickyFooter"><div class="u-maxWidth700 u-marginAuto u-flexCenter"><div class="u-fontSize16 u-flex1 u-flexCenter"><div class="u-flex0 u-inlineBlock u-paddingRight20 u-xs-paddingRight10"><a class="link u-baseColor--link avatar u-inline"   href="https://medium.com/@adam.toscher" data-action="show-user-card" data-action-value="626cae9ed375" data-action-type="hover" data-user-id="626cae9ed375" dir="auto"><div class="u-relative u-inlineBlock u-flex0"><img  src="https://cdn-images-1.medium.com/fit/c/80/80/0*s_J0fTAsy4Azb0dt." class="avatar-image avatar-image--smaller" alt="Go to the profile of Adam Toscher"><div class="avatar-halo u-absolute u-textColorGreenNormal svgIcon" style="width: calc(100% + 10px); height: calc(100% + 10px); top:-5px; left:-5px"><svg viewBox="0 0 70 70" xmlns="http://www.w3.org/2000/svg"><path d="M5.53538374,19.9430227 C11.180401,8.78497536 22.6271155,1.6 35.3571429,1.6 C48.0871702,1.6 59.5338847,8.78497536 65.178902,19.9430227 L66.2496695,19.401306 C60.4023065,7.84329843 48.5440457,0.4 35.3571429,0.4 C22.17024,0.4 10.3119792,7.84329843 4.46461626,19.401306 L5.53538374,19.9430227 Z"></path><path d="M65.178902,49.9077131 C59.5338847,61.0657604 48.0871702,68.2507358 35.3571429,68.2507358 C22.6271155,68.2507358 11.180401,61.0657604 5.53538374,49.9077131 L4.46461626,50.4494298 C10.3119792,62.0074373 22.17024,69.4507358 35.3571429,69.4507358 C48.5440457,69.4507358 60.4023065,62.0074373 66.2496695,50.4494298 L65.178902,49.9077131 Z"></path></svg></div></div></a></div><div class="u-flex1 u-inlineBlock"><div class="u-xs-hide">Never miss a story from<strong> Adam Toscher</strong>, when you sign up for Medium. <a class="link u-baseColor--link link--accent u-accentColor--textNormal u-accentColor--textDarken"   href="https://medium.com/@Medium/personalize-your-medium-experience-with-users-publications-tags-26a41ab1ee0c#.hx4zuv3mg" data-action-source="sticky_footer">Learn more</a></div><div class="u-xs-show">Never miss a story from<strong> Adam Toscher</strong></div></div></div><div class="u-marginLeft50 u-xs-marginAuto"><span class="followState js-followState" data-user-id="626cae9ed375"><button class="button u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-uiTextSemibold u-textUppercase u-fontSize12"  data-action="sign-up-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-redirect="https://medium.com/@adam.toscher/top-five-ways-i-got-domain-admin-on-your-internal-network-before-lunch-2018-edition-82259ab73aaa" data-action-source="sticky_footer"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary is-active u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton u-uiTextSemibold u-textUppercase u-fontSize12"  data-action="sign-up-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/626cae9ed375" data-action-source="sticky_footer-626cae9ed375-------------------------follow_metabar"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Get updates</span></button></span></div></div></div></div></div></div><div class="loadingBar"></div><script>// <![CDATA[
window["obvInit"] = function (opt_embedded) {window["obvInit"]["embedded"] = opt_embedded; window["obvInit"]["ready"] = true;}
// ]]></script><script>// <![CDATA[
var GLOBALS = {"audioUrl":"https://d1fcbxp97j4nb2.cloudfront.net","baseUrl":"https://medium.com","buildLabel":"32922-7f9e4c0","currentUser":{"userId":"lo_PnKi7DWRkJf6","isVerified":false,"subscriberEmail":"","hasPastMemberships":false,"isEnrolledInHightower":false,"isEligibleForHightower":false,"hightowerLastLockedAt":0},"currentUserHasUnverifiedEmail":false,"isAuthenticated":false,"isCurrentUserVerified":false,"language":"en-us","mediumTwitterScreenName":"medium","miroUrl":"https://cdn-images-1.medium.com","moduleUrls":{"base":"https://cdn-static-1.medium.com/_/fp/gen-js/main-base.bundle.Vx7z9F5RV81Q8U99QGumjw.js","common-async":"https://cdn-static-1.medium.com/_/fp/gen-js/main-common-async.bundle.6u-b2UeswOdwOlssQqe_wA.js","hightower":"https://cdn-static-1.medium.com/_/fp/gen-js/main-hightower.bundle.zZaO4pim09pg3U-hIYG6hQ.js","home-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-home-screens.bundle.MIG4o8YfK9vBO-dbYTIP_Q.js","misc-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-misc-screens.bundle.6xuvOyAuXxq-4qPL3xFQ5A.js","notes":"https://cdn-static-1.medium.com/_/fp/gen-js/main-notes.bundle.QggWJfjbFZeOkXFNohnzfw.js","payments":"https://cdn-static-1.medium.com/_/fp/gen-js/main-payments.bundle.9mk-eTzYKwy8Sz7LhG0U_w.js","posters":"https://cdn-static-1.medium.com/_/fp/gen-js/main-posters.bundle.wQsq8kOCi4ShyLRztu4MTQ.js","power-readers":"https://cdn-static-1.medium.com/_/fp/gen-js/main-power-readers.bundle.aoicnU2sHgwWbYHb9V7hTA.js","pubs":"https://cdn-static-1.medium.com/_/fp/gen-js/main-pubs.bundle.wucJv6RhBx0RfCWrHSTbXA.js","stats":"https://cdn-static-1.medium.com/_/fp/gen-js/main-stats.bundle.HPWQIRkZ3SR3fCLnFZfgSw.js"},"previewConfig":{"weightThreshold":1,"weightImageParagraph":0.51,"weightIframeParagraph":0.8,"weightTextParagraph":0.08,"weightEmptyParagraph":0,"weightP":0.003,"weightH":0.005,"weightBq":0.003,"minPTextLength":60,"truncateBoundaryChars":20,"detectTitle":true,"detectTitleLevThreshold":0.15},"productName":"Medium","supportsEdit":false,"termsUrl":"//medium.com/policy/9db0094a1e0f","textshotHost":"textshot.medium.com","transactionId":"1520661348089:1ad5fde2b583","useragent":{"browser":"cfnetwork","family":"","os":"","version":0,"supportsDesktopEdit":false,"supportsInteract":false,"supportsView":true,"isMobile":false,"isTablet":false,"isNative":false,"supportsFileAPI":false,"isTier1":false,"clientVersion":"","unknownParagraphsBad":false,"clientChannel":"","supportsRealScrollEvents":false,"supportsVhUnits":false,"ruinsViewportSections":false,"supportsHtml5Video":false,"supportsMagicUnderlines":false,"isWebView":false,"isFacebookWebView":false,"supportsProgressiveMedia":false,"supportsPromotedPosts":true,"isBot":false,"isNativeIphone":false,"supportsCssVariables":false,"supportsVideoSections":true,"emojiSupportLevel":1,"isSearchBot":false,"supportsScrollableMetabar":false},"variants":{"allow_access":true,"allow_signup":true,"allow_test_auth":"disallow","signin_services":"twitter,facebook,google,email,google-fastidv","signup_services":"twitter,facebook,google,email,google-fastidv","android_rating_prompt_recommend_threshold":5,"google_sign_in_android":true,"reengagement_notification_duration":3,"browsable_stream_config_bucket":"curated-topics","enable_series_creation":true,"enable_your_series_pages":true,"enable_productionized_series":true,"enable_dedicated_series_tab_api_ios":true,"enable_clap_milestone_notifications":true,"enable_series_stats_page":true,"enable_post_import":true,"enable_sponsored_post_labelling":true,"enable_logged_in_follow_on_collection_post":true,"enable_export_members":true,"enable_series_card_background_creation":true,"available_monthly_plan":"60e220181034","available_annual_plan":"2c754bcc2995","enable_sms":true,"enable_smyte_on_old_content":true,"is_not_medium_subscriber":true,"disable_followed_tag_fan_out":true,"enable_glyph":true,"glyph_font_set":"m2","enable_branding":true,"enable_branding_fonts":true,"enable_branding_buttons":true,"enable_sequence_carousel":true,"enable_multirecommends":true,"enable_view_new_collection_writers_manager":true,"enable_post_monger_v2":true,"enable_user_post_metering":true,"max_premium_content_per_user_under_metering":3,"tag_intercom_user_on_metering_count":3,"enable_topic_writer_onboarding":true,"enable_algolia_search_reporting":true,"enable_strong_graph_chp_reorder":true,"enable_unsplash_images":true,"enable_top_stories_for_you":true,"enable_ios_member_post_labeling":true,"enable_featured_hero":true,"enable_li_search_collection":true,"enable_audio_playlists":true,"enable_homepage_remodel":true,"enable_signin_wall_custom_domain":true,"enable_standalone_profile_edit_page":true,"enable_standalone_user_follow_pages":true,"enable_post_footer_copy":true,"app_download_email_template":"control","enable_bloomd_double_write":true,"enable_bloomd_sharding":true,"enable_hack_series_web":true,"disable_digest_deep_social_provider":true,"enable_elevate_sequence":true,"enable_infinite_ranked_feed":true,"enable_editors_picks_notifications":true,"enable_digest_follow_topics":true,"enable_marketing_emails":true,"enable_experiment_edit_in_new_tab":true,"enable_new_topic_provider_digest_3_posts":true},"xsrfToken":"","iosAppId":"828256236","supportEmail":"yourfriends@medium.com","fp":{"/icons/monogram-mask.svg":"https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg","/icons/favicon-dev-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-dev-editor.YKKRxBO8EMvIqhyCwIiJeQ.ico","/icons/favicon-hatch-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-hatch-editor.BuEyHIqlyh2s_XEk4Rl32Q.ico","/icons/favicon-medium-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-medium-editor.PiakrZWB7Yb80quUVQWM6g.ico"},"authBaseUrl":"https://medium.com","imageUploadSizeMb":25,"isAuthDomainRequest":true,"algoliaApiEndpoint":"https://MQ57UUUQZ2-dsn.algolia.net","algoliaAppId":"MQ57UUUQZ2","algoliaSearchOnlyApiKey":"394474ced050e3911ae2249ecc774921","iosAppStoreUrl":"https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8","iosAppLinkBaseUrl":"medium:","algoliaIndexPrefix":"medium_","androidPlayStoreUrl":"https://play.google.com/store/apps/details?id=com.medium.reader","googleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","androidPackage":"com.medium.reader","androidPlayStoreMarketScheme":"market://details?id=com.medium.reader","googleAuthUri":"https://accounts.google.com/o/oauth2/auth","androidScheme":"medium","layoutData":{"useDynamicScripts":false,"googleAnalyticsTrackingCode":"UA-24232453-2","jsShivUrl":"https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js","useDynamicCss":false,"faviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico","faviconImageId":"1*8I-HPL0bfoIzGied-dzOvA.png","fontSets":[{"id":8,"url":"https://glyph.medium.com/css/e/sr/latin/e/ssr/latin/e/ssb/latin/m2.css"},{"id":9,"url":"https://glyph.medium.com/css/mkt.css"},{"id":10,"url":"https://glyph.medium.com/css/elv8.css"}],"editorFaviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium-editor.3Y6xpZ-0FSdWDnPM3hSBIA.ico","glyphUrl":"https://glyph.medium.com"},"authBaseUrlRev":"moc.muidem//:sptth","isDnt":false,"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","archiveUploadSizeMb":100,"paymentData":{"currencies":{"1":{"label":"US Dollar","external":"usd"}},"countries":{"1":{"label":"United States of America","external":"US"}},"accountTypes":{"1":{"label":"Individual","external":"individual"},"2":{"label":"Company","external":"company"}}},"previewConfig2":{"weightThreshold":1,"weightImageParagraph":0.05,"raiseImage":true,"enforceHeaderHierarchy":true,"isImageInsetRight":true},"isAmp":false,"iosScheme":"medium","isSwBoot":false,"lightstep":{"accessToken":"ce5be895bef60919541332990ac9fef2","carrier":"{\"ot-tracer-spanid\":\"7fc68d5c1ec330d9\",\"ot-tracer-traceid\":\"27e035e206991096\",\"ot-tracer-sampled\":\"true\"}","host":"collector-medium.lightstep.com"},"facebook":{"key":"542599432471018","namespace":"medium-com","scope":{"default":["public_profile","email","user_friends"],"connect":["public_profile","email","user_friends"],"login":["public_profile","email","user_friends"],"share":["public_profile","email","user_friends","publish_actions"]}},"mailingListArchiveUploadSizeMb":2,"editorsPicksTopicId":"3985d2a191c5","popularOnMediumTopicId":"9d34e48ecf94","memberContentTopicId":"13d7efd82fb2","audioContentTopicId":"3792abbd134","brandedSequenceId":"7d337ddf1941","isDoNotAuth":false,"goldfinchUrl":"https://goldfinch.medium.com","buggle":{"url":"https://buggle.medium.com","videoUrl":"https://cdn-videos-1.medium.com","audioUrl":"https://cdn-audio-1.medium.com"},"referrerType":5,"isMeteredOut":false,"meterConfig":{"maxUnlockCount":3,"windowLength":"MONTHLY"},"partnerProgramEmail":"partnerprogram@medium.com","userResearchPrompts":[{"promptId":"lo_post_page_4","type":0,"url":"www.calendly.com"},{"promptId":"lo_home_page","type":1,"url":"www.calendly.com"},{"promptId":"lo_profile_page","type":2,"url":"www.calendly.com"}],"recaptchaKey":"6LdAokEUAAAAAC7seICd4vtC8chDb3jIXDQulyUJ","paypalClientMode":"production","signinWallCustomDomainCollectionIds":["3a8144eabfe3"],"countryCode":"US"}
// ]]></script><script charset="UTF-8" src="https://cdn-static-1.medium.com/_/fp/gen-js/main-base.bundle.Vx7z9F5RV81Q8U99QGumjw.js" async></script><script>// <![CDATA[
window["obvInit"]({"value":{"id":"82259ab73aaa","versionId":"2db0925af505","creatorId":"626cae9ed375","creator":{"userId":"626cae9ed375","name":"Adam Toscher","username":"adam.toscher","createdAt":1500334773422,"lastPostCreatedAt":1520616888366,"imageId":"0*s_J0fTAsy4Azb0dt.","backgroundImageId":"","bio":"Adam is an independent penetration tester who has over 20 years of experience in the technology industry.","twitterScreenName":"","socialStats":{"userId":"626cae9ed375","usersFollowedCount":4,"usersFollowedByCount":16,"type":"SocialStats"},"social":{"userId":"lo_PnKi7DWRkJf6","targetUserId":"626cae9ed375","type":"Social"},"facebookAccountId":"","allowNotes":1,"mediumMemberAt":1506955772000,"isNsfw":false,"type":"User"},"homeCollectionId":"","title":"Top Five Ways I Got Domain Admin on Your Internal Network before Lunch (2018 Edition)","detectedLanguage":"en","latestVersion":"2db0925af505","latestPublishedVersion":"2db0925af505","hasUnpublishedEdits":false,"latestRev":1080,"createdAt":1520616888366,"updatedAt":1520657864244,"acceptedAt":0,"firstPublishedAt":1520624748380,"latestPublishedAt":1520633029443,"vote":false,"experimentalCss":"","displayAuthor":"","content":{"subtitle":"A Scary Thought: I’ve worked in the Cyber Security space performing a wide breadth of penetration and red team services for years. Yes it’s…","bodyModel":{"paragraphs":[{"name":"5f23","type":3,"text":"Top Five Ways I Got Domain Admin on Your Internal Network before Lunch (2018 Edition)","markups":[]},{"name":"7f3a","type":1,"text":"A Scary Thought: I’ve worked in the Cyber Security space performing a wide breadth of penetration and red team services for years. Yes it’s still as easy (if not more so in this day and age!) to obtain Domain Admin “before lunch” as it was when I first started pen-testing.","markups":[]},{"name":"d9e0","type":1,"text":"Back in September of 2013, Spider Labs wrote an article titled “Top Five Ways SpiderLabs Got Domain Admin on Your Internal Network” This article is written to compliment and serve as a Part 2 of sorts to the original SpiderLabs Blog post.","markups":[{"type":3,"start":64,"end":130,"href":"https://www.trustwave.com/Resources/SpiderLabs-Blog/Top-Five-Ways-SpiderLabs-Got-Domain-Admin-on-Your-Internal-Network/","title":"","rel":"noopener","anchorType":0},{"type":1,"start":64,"end":132}]},{"name":"cb2c","type":10,"text":"Netbios and LLMNR Name Poisoning","markups":[{"type":1,"start":0,"end":32}]},{"name":"6ba3","type":7,"text":"I wish I could say that Netbios/LLMNR is not as prevalent as it was in 2013; but a vast majority of assessments, result in pen testers obtaining hashes, and reversing NTLMv1/v2 hashes and recovering plain text credentials. To assist you with your recently recovered hashes, there are now advanced frameworks to help with password cracking like hate_crack.","markups":[{"type":3,"start":344,"end":354,"href":"https://github.com/trustedsec/hate_crack","title":"","rel":"noopener","anchorType":0}]},{"name":"82db","type":7,"text":"I personally had great success using a common wordlist that can be obtained for a nominal fee: “uniqpass” and the out of box common hashcat ruleset “best64”. But sometimes complex passwords are enforced, and you’re left with no other option but to crack some hashes.","markups":[{"type":3,"start":96,"end":104,"href":"https://webcache.googleusercontent.com/search?q=cache:BV8AEB0cWtcJ:https://dazzlepod.com/uniqpass/+&cd=1&hl=en&ct=clnk&gl=us","title":"","rel":"noopener","anchorType":0}]},{"name":"67ce","type":7,"text":"Responder, thought not actively maintained by Spider Labs is still arguably the go to tool for all things related to mitm poisoning and spoofing.","markups":[{"type":3,"start":0,"end":10,"href":"https://github.com/lgandx/Responder","title":"","rel":"noopener","anchorType":0}]},{"name":"058a","type":1,"text":"Inveigh, the native Windows .NET sibling of the Unix/Linux Python based Responder","markups":[{"type":3,"start":0,"end":7,"href":"https://github.com/Kevin-Robertson/Inveigh","title":"","rel":"noopener","anchorType":0}]},{"name":"f6d8","type":7,"text":"Inveigh its core is a .NET packet sniffer that listens for and responds to LLMNR/mDNS/NBNS requests while also capturing incoming NTLMv1/NTLMv2 authentication attempts over the Windows SMB service.","markups":[]},{"name":"d59b","type":1,"text":"Both man-in-the-middle tools are designed to assist penetration testers/red teamers that find themselves limited to a Windows system.","markups":[]},{"name":"a947","type":1,"text":"2. Relay attacks","markups":[{"type":1,"start":0,"end":16}]},{"name":"aec5","type":1,"text":"The newer MultiReplay tool is maintained by: Laurent Gaffie, which is designed for seem-less integration with the Responder framework for easing the difficulty when performing SMB relay attacks.","markups":[]},{"name":"0ef7","type":1,"text":"I personally prefer impacket’s tools, for relaying and other penetration testing needs. Impacket’s tools I find to be reliable and stable on most unixes and run natively on Mac OS. Comparatively to other free open source tools, they leave a relatively small forensic footprint when executed on a host (If you’re worried about noise, are trying to be evasive, or have to fend off a Blue Team).","markups":[]},{"name":"5c88","type":1,"text":"To prepare for some DA pwnage lets get impacket installed.","markups":[{"type":3,"start":39,"end":46,"href":"https://github.com/CoreSecurity/impacket","title":"","rel":"","anchorType":0}]},{"name":"c940","type":3,"text":"SMB Relaying explained:","markups":[{"type":1,"start":0,"end":23}]},{"name":"df32","type":1,"text":"smbrelayx.py","markups":[{"type":3,"start":0,"end":12,"href":"https://github.com/CoreSecurity/impacket/blob/impacket_0_9_15/examples/smbrelayx.py","title":"","rel":"","anchorType":0},{"type":1,"start":0,"end":12}]},{"name":"0f01","type":7,"text":"This module performs the SMB Relay attacks originally discovered by cDc. It receives a list of targets and for every connection received it will choose the next target and try to relay the credentials. Also, if specified, it will first to try authenticate against the client connecting to us.\nIt is implemented by invoking a SMB and HTTP Server, hooking to a few functions and then using the smbclient portion. It is supposed to be working on any LM Compatibility level. The only way to stop this attack is to enforce on the server SPN checks and or signing. If the authentication against the targets succeed, the client authentication success as well and a valid connection is set against the local smbserver. It’s up to the user to set up the local smbserver functionality. One option is to set up shares with whatever files you want to the victim thinks it’s connected to a valid SMB server. All that is done through the smb.conf file or programmatically.","markups":[]},{"name":"3545","type":3,"text":"NTLM Relaying explained","markups":[{"type":3,"start":0,"end":23,"href":"https://www.fox-it.com/en/insights/blogs/blog/inside-windows-network/","title":"","rel":"","anchorType":0},{"type":1,"start":0,"end":23}]},{"name":"2173","type":1,"text":"ntlmrelayx.py","markups":[{"type":3,"start":0,"end":13,"href":"https://github.com/CoreSecurity/impacket/blob/master/examples/ntlmrelayx.py","title":"","rel":"","anchorType":0},{"type":1,"start":0,"end":13}]},{"name":"1192","type":7,"text":"NTLM Authentication is a challenge-response based protocol. Challenge-response protocols use a commonly shared secret, in this case the user password, to authenticate the client. The server sends a challenge, and the client replies with the response on this challenge. If the challenge matches the one calculated by the server, the authentication is accepted. The NTLM Authentication is a complex protocol, and how it is explained here is a simplification. A very good and detailed description can be found at http://davenport.sourceforge.net/ntlm.html","markups":[{"type":3,"start":510,"end":552,"href":"http://davenport.sourceforge.net/ntlm.html","title":"","rel":"","anchorType":0}]},{"name":"1641","type":4,"text":"ntmlreayx and a randomized selection of targets","markups":[],"layout":1,"metadata":{"id":"1*MeIC7wR1YNcKcDwBIyPCkg.png","originalWidth":362,"originalHeight":80}},{"name":"8604","type":1,"text":"Both SMBRelay and the newer attacks take advantage of Windows computers who don’t enforce SMB signing, allowing a privileged user to authenticate via SMB/NTLM authentication mechanisms.","markups":[]},{"name":"9abe","type":9,"text":"It’s important to note that the targets file contained a list of Windows hosts on different networks. A nice trick of mine is to create your target lists of non smb signed hosts in a randomized fashion","markups":[]},{"name":"a81c","type":9,"text":"The host list which expedited me getting domain admin allowed Domain Users local admin access to a SQL server that shared the same local admin password with a Domain controller","markups":[]},{"name":"c9d9","type":13,"text":"By default ntlmrealyx runs secretsdumps if you do not specify a binary to execute.","markups":[]},{"name":"48fc","type":4,"text":"Administrator hash","markups":[],"layout":1,"metadata":{"id":"1*pOO-cX5cNUfEn1o32-SFPA.png","originalWidth":2739,"originalHeight":325}},{"name":"f9a6","type":1,"text":"After a successful NTLM Relay you’ll find the file with hashes named “IP_samhashes” in the directory where you executed ntmrelayx.","markups":[]},{"name":"0e8c","type":1,"text":"Using this administrator hash, I obtained DA with the infamous pass-the-hash technique’ using impacket’s wmiexec.py","markups":[{"type":3,"start":63,"end":77,"href":"https://www.sans.org/reading-room/whitepapers/testing/pass-the-hash-attacks-tools-mitigation-33283","title":"","rel":"","anchorType":0}]},{"name":"0dad","type":4,"text":"Shell access to the Domain Controller","markups":[],"layout":1,"metadata":{"id":"1*dukE-2XCk_6I9FGb98sfmQ.png","originalWidth":2828,"originalHeight":329}},{"name":"f890","type":4,"text":"mitm6 + ntlmrelayx + pth = Domain ADmin","markups":[],"layout":1,"metadata":{"id":"1*vnEng8O4sGJ1DENY2SmiqA.png","originalWidth":2139,"originalHeight":1465,"isFeatured":true}},{"name":"0f4c","type":1,"text":"In the scenario above, I was able to relay credentials from one network to another and recover an administrator hash that could be passed with wmiexec.py. This particular local administrator hash allowed me to gain Domain administrator without cracking a password, or even having a valid Domain user account beforehand.","markups":[{"type":3,"start":143,"end":155,"href":"https://github.com/CoreSecurity/impacket/blob/master/examples/wmiexec.py","title":"","rel":"","anchorType":0}]},{"name":"f67f","type":1,"text":"3. MS17–010","markups":[{"type":3,"start":3,"end":11,"href":"https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS17-010/ms17_010_eternalblue.rb","title":"","rel":"","anchorType":0},{"type":1,"start":0,"end":11}]},{"name":"e82f","type":1,"text":"nmap -Pn -p445 — open — max-hostgroup 3 — script smb-vuln-ms17–010 \x3cip_netblock\x3e","markups":[{"type":3,"start":0,"end":80,"href":"https://isc.sans.edu/forums/diary/Using+nmap+to+scan+for+MS17010+CVE20170143+EternalBlue/22574/","title":"","rel":"","anchorType":0},{"type":1,"start":0,"end":80}]},{"name":"b1e8","type":7,"text":"ETERNALBLUE, ETERNALCHAMPION, ETERNALROMANCE, and ETERNALSYNERGY are four of multiple Equation Group vulnerabilities and exploits disclosed on 2017/04/14 by a group known as the Shadow Brokers. WannaCry / WannaCrypt is a ransomware program utilizing the ETERNALBLUE exploit, and EternalRocks is a worm that utilizes seven Equation Group vulnerabilities. Petya is a ransomware program that first utilizes CVE-2017–0199, a vulnerability in Microsoft Office, and then spreads via ETERNALBLUE.","markups":[]},{"name":"a587","type":4,"text":"2018’s “8067”","markups":[],"layout":1,"metadata":{"id":"1*Nh7ufmdlWuyz1A6uOQvgSg.png","originalWidth":1145,"originalHeight":607}},{"name":"bcee","type":1,"text":"4. Kerberoasting","markups":[{"type":3,"start":3,"end":16,"href":"https://www.blackhillsinfosec.com/a-toast-to-kerberoast/","title":"","rel":"","anchorType":0},{"type":1,"start":3,"end":16}]},{"name":"9e11","type":7,"text":"Recently I have had a lot of success with privilege escalation in an Active Directory domain environment using an attack called Kerberoasting. Tim Medin presented this technique at SANS Hackfest 2014 and since then there have been numerous awesome articles and conference talks on the details of the attack and tools written for different techniques to pull it off (reference links at the bottom of the post).","markups":[{"type":3,"start":143,"end":152,"href":"https://twitter.com/TimMedin","title":"","rel":"","anchorType":0},{"type":3,"start":181,"end":199,"href":"https://files.sans.org/summit/hackfest2014/PDFs/Kicking%20the%20Guard%20Dog%20of%20Hades%20-%20Attacking%20Microsoft%20Kerberos%20-%20Tim%20Medin(1).pdf","title":"","rel":"","anchorType":0}]},{"name":"9be2","type":7,"text":"The Microsoft implementation of Kerberos can be a bit complicated, but the gist of the attack is that it takes advantage of legacy Active Directory support for older Windows clients and the type of encryption used and the key material used to encrypt and sign Kerberos tickets. Essentially, when a domain account is configured to run a service in the environment, such as MS SQL, a Service Principal Name (SPN) is used in the domain to associate the service with a login account. When a user wishes to use the specific resource they receive a Kerberos ticket signed with NTLM hash of the account that is running the service","markups":[]},{"name":"ee51","type":1,"text":"Example below from mubix’s site","markups":[{"type":3,"start":19,"end":31,"href":"https://room362.com/post/2016/kerberoast-pt1/","title":"","rel":"noopener","anchorType":0}]},{"name":"0b26","type":8,"text":"root@wpad:~/impacket/examples# ./GetUserSPNs.py -dc-ip 192.168.168.10 sittingduck.info/notanadmin\nImpacket v0.9.15-dev - Copyright 2002-2016 Core Security Technologies\n\nPassword:\nServicePrincipalName                Name        MemberOf                                          PasswordLastSet\n----------------------------------  ----------  ------------------------------------------------  -------------------\nhttp/win10.sittingduck.info         uberuser    CN=Domain Admins,CN=Users,DC=sittingduck,DC=info  2015-11-10 23:47:21\nMSSQLSvc/WIN2K8R2.sittingduck.info  sqladmin01                                                    2016-05-13 19:13:20","markups":[{"type":10,"start":0,"end":646}]},{"name":"760a","type":1,"text":"5. mitm6","markups":[{"type":1,"start":3,"end":8}]},{"name":"b2e8","type":1,"text":"Mitm6 is an incredibly powerful tool for obtaining and escalating privileges on a your typical Windows broadcast network. When other attacks above fail on their own; try chaining smbrelay + mitm6 or it’s default counterpart ntlmreayx. Use your imagination, and harness the power of mitm6 to gain DA before lunch!","markups":[]},{"name":"be9b","type":4,"text":"mitm6 spoofing","markups":[],"layout":1,"metadata":{"id":"1*puHYIgmUcLKQerVLjPTJeg.png","originalWidth":1684,"originalHeight":605}},{"name":"7eeb","type":1,"text":"Usage with ntlmrelayx:","markups":[{"type":1,"start":0,"end":22}]},{"name":"2d1e","type":7,"text":"mitm6 is designed to be used with ntlmrelayx. You should run the tools next to each other, in this scenario mitm6 will spoof the DNS, causing victims to connect to ntlmrelayx for HTTP and SMB connections. For this you have to make sure to run ntlmrelayx with the -6 option, which will make it listen on both IPv4 and IPv6. To obtain credentials for WPAD, specify the WPAD hostname to spoof with -wh HOSTNAME (any non-existing hostname in the local domain will work since mitm6 is the DNS server). Optionally you can also use the -wa N parameter with a number of attempts to prompt for authentication for the WPAD file itself in case you suspect victims do not have the MS16-077 patch applied.","markups":[{"type":10,"start":263,"end":265},{"type":10,"start":395,"end":407},{"type":10,"start":529,"end":534}]},{"name":"c963","type":7,"text":"mitm6 is a pentesting tool that exploits the default configuration of Windows to take over the default DNS server. It does this by replying to DHCPv6 messages, providing victims with a link-local IPv6 address and setting the attackers host as default DNS server. As DNS server, mitm6 will selectively reply to DNS queries of the attackers choosing and redirect the victims traffic to the attacker machine instead of the legitimate server. For a full explanation of the attack, see our blog about mitm6. Mitm6 is designed to work together with ntlmrelayx from impacket for WPAD spoofing and credential relaying.","markups":[{"type":3,"start":485,"end":501,"href":"https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/","title":"","rel":"nofollow","anchorType":0},{"type":3,"start":543,"end":567,"href":"https://github.com/CoreSecurity/impacket","title":"","rel":"","anchorType":0}]},{"name":"e205","type":6,"text":"Reference below: Many parts of this blog are directly cited and copied from the sources below. All credit goes to those, whose amazing work I have either cited or used for obtaining Domain Admin in the realz.","markups":[],"hasDropCap":true},{"name":"8aa3","type":1,"text":"Hack all things and be responsible!!!","markups":[{"type":2,"start":0,"end":37}]},{"name":"4ab3","type":14,"text":"Using a SCF file to Gather Hashes\nHave you ever been on a internal network assessment and discovered an unauthenticated writable Windows-based file…1337red.wordpress.com","markups":[{"type":3,"start":0,"end":169,"href":"https://1337red.wordpress.com/using-a-scf-file-to-gather-hashes/","title":"https://1337red.wordpress.com/using-a-scf-file-to-gather-hashes/","rel":"","anchorType":0},{"type":1,"start":0,"end":33},{"type":2,"start":34,"end":148}],"mixtapeMetadata":{"mediaResourceId":"227de21a2802978d75b62f05de8e4049","thumbnailImageId":"0*o0gpgyik2TPYQ3BA.","href":"https://1337red.wordpress.com/using-a-scf-file-to-gather-hashes/"}},{"name":"11be","type":14,"text":"lgandx/Responder\nResponder is a LLMNR, NBT-NS and MDNS poisoner, with built-in HTTP/SMB/MSSQL/FTP/LDAP rogue authentication server…github.com","markups":[{"type":3,"start":0,"end":141,"href":"https://github.com/lgandx/Responder","title":"https://github.com/lgandx/Responder","rel":"","anchorType":0},{"type":1,"start":0,"end":16},{"type":2,"start":17,"end":131}],"mixtapeMetadata":{"mediaResourceId":"213537811f3639a23f7a27d5bd64bf08","thumbnailImageId":"0*kmiBWDUnx9qVPwAa.","href":"https://github.com/lgandx/Responder"}},{"name":"6da7","type":14,"text":"Kevin-Robertson/Inveigh\nInveigh is a Windows PowerShell LLMNR/mDNS/NBNS spoofer/man-in-the-middle toolgithub.com","markups":[{"type":3,"start":0,"end":112,"href":"https://github.com/Kevin-Robertson/Inveigh","title":"https://github.com/Kevin-Robertson/Inveigh","rel":"","anchorType":0},{"type":1,"start":0,"end":23},{"type":2,"start":24,"end":102}],"mixtapeMetadata":{"mediaResourceId":"2fa28ae4b0f16210c33cb4312ffc3d05","thumbnailImageId":"0*uOi3jTh9TawFR_2H.","href":"https://github.com/Kevin-Robertson/Inveigh"}},{"name":"18d5","type":14,"text":"purpleteam/snarf\nsnarf - Snarf man-in-the-middle / relay suitegithub.com","markups":[{"type":3,"start":0,"end":72,"href":"https://github.com/purpleteam/snarf","title":"https://github.com/purpleteam/snarf","rel":"","anchorType":0},{"type":1,"start":0,"end":16},{"type":2,"start":17,"end":62}],"mixtapeMetadata":{"mediaResourceId":"7dbc9d555c2622d36057e1dd9b42e36e","thumbnailImageId":"0*0yMkSOrEI6Zz7cV7.","href":"https://github.com/purpleteam/snarf"}},{"name":"1ed9","type":14,"text":"fox-it/mitm6\nmitm6 - pwning IPv4 via IPv6github.com","markups":[{"type":3,"start":0,"end":51,"href":"https://github.com/fox-it/mitm6","title":"https://github.com/fox-it/mitm6","rel":"","anchorType":0},{"type":1,"start":0,"end":12},{"type":2,"start":13,"end":41}],"mixtapeMetadata":{"mediaResourceId":"37097e779800eecdf3e9c0cb267bd240","thumbnailImageId":"0*pzfIiIOxtT_66XzQ.","href":"https://github.com/fox-it/mitm6"}},{"name":"4c3a","type":14,"text":"A Toast to Kerberoast - Black Hills Information Security\nDerek Banks // This post will walk through a technique to remotely run a Kerberoast attack over an established…www.blackhillsinfosec.com","markups":[{"type":3,"start":0,"end":193,"href":"https://www.blackhillsinfosec.com/a-toast-to-kerberoast/","title":"https://www.blackhillsinfosec.com/a-toast-to-kerberoast/","rel":"","anchorType":0},{"type":1,"start":0,"end":56},{"type":2,"start":57,"end":168}],"mixtapeMetadata":{"mediaResourceId":"ad83e7dfbd9b352bb36b8c20041107a3","thumbnailImageId":"0*4q4RAgXPkDR51RSN.","href":"https://www.blackhillsinfosec.com/a-toast-to-kerberoast/"}},{"name":"0253","type":14,"text":"Common weaknesses in your Windows network - Fox-IT (ENG)\nAt Fox-IT we are committed to making our clients aware of common security risks in their organizations. Credential…www.fox-it.com","markups":[{"type":3,"start":0,"end":186,"href":"https://www.fox-it.com/en/insights/blogs/blog/inside-windows-network/","title":"https://www.fox-it.com/en/insights/blogs/blog/inside-windows-network/","rel":"","anchorType":0},{"type":1,"start":0,"end":56},{"type":2,"start":57,"end":172}],"mixtapeMetadata":{"mediaResourceId":"2b5a7b39281449caa674957e851b37ee","thumbnailImageId":"0*HFnrLRfoH2A6_Xws.","href":"https://www.fox-it.com/en/insights/blogs/blog/inside-windows-network/"}},{"name":"6fbe","type":14,"text":"SecWiki/windows-kernel-exploits\nwindows-kernel-exploits Windows平台提权漏洞集合github.com","markups":[{"type":3,"start":0,"end":81,"href":"https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS17-010/ms17_010_eternalblue.rb","title":"https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS17-010/ms17_010_eternalblue.rb","rel":"","anchorType":0},{"type":1,"start":0,"end":31},{"type":2,"start":32,"end":71}],"mixtapeMetadata":{"mediaResourceId":"88ec04a3d2fc3e79e4c1950699669c6e","thumbnailImageId":"0*AR-Ngh4J41G004Cu.","href":"https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS17-010/ms17_010_eternalblue.rb"}},{"name":"fbd8","type":14,"text":"Kerberoasting - Part 1\nPrevious works: There has been a number of differnet blog posts, presentations and projects that have happened before…room362.com","markups":[{"type":3,"start":0,"end":152,"href":"https://room362.com/post/2016/kerberoast-pt1/","title":"https://room362.com/post/2016/kerberoast-pt1/","rel":"","anchorType":0},{"type":1,"start":0,"end":22},{"type":2,"start":23,"end":141}],"mixtapeMetadata":{"mediaResourceId":"f652be17729ecccddf3af5ade99a9b71","thumbnailImageId":"","href":"https://room362.com/post/2016/kerberoast-pt1/"}},{"name":"745b","type":1,"text":"https://isc.sans.edu/forums/diary/Using+nmap+to+scan+for+MS17010+CVE20170143+EternalBlue/22574","markups":[{"type":3,"start":0,"end":94,"href":"https://isc.sans.edu/forums/diary/Using+nmap+to+scan+for+MS17010+CVE20170143+EternalBlue/22574","title":"","rel":"nofollow noopener","anchorType":0}]}],"sections":[{"name":"7b1a","startIndex":0}]},"postDisplay":{"coverless":true}},"virtuals":{"allowNotes":true,"previewImage":{"imageId":"1*vnEng8O4sGJ1DENY2SmiqA.png","filter":"","backgroundSize":"","originalWidth":2139,"originalHeight":1465,"strategy":"resample","height":0,"width":0},"wordCount":1641,"imageCount":6,"readingTime":7.142452830188679,"subtitle":"A Scary Thought: I’ve worked in the Cyber Security space performing a wide breadth of penetration and red team services for years. Yes it’s…","usersBySocialRecommends":[],"recommends":6,"socialRecommends":[],"isBookmarked":false,"tags":[{"slug":"penetration-testing","name":"Penetration Testing","postCount":450,"virtuals":{"isFollowing":false},"metadata":{"followerCount":172,"postCount":450,"coverImage":{"id":"1*KK8lKqzDrFn8F0gbJ69Axw.png","originalWidth":800,"originalHeight":600}},"type":"Tag"},{"slug":"security","name":"Security","postCount":29190,"virtuals":{"isFollowing":false},"metadata":{"followerCount":5234,"postCount":29190,"coverImage":{"id":"1*ETvXCCF1aTIj9Kial1iOhQ.jpeg","originalWidth":500,"originalHeight":387}},"type":"Tag"},{"slug":"cybersecurity","name":"Cybersecurity","postCount":16751,"virtuals":{"isFollowing":false},"metadata":{"followerCount":3417,"postCount":16751,"coverImage":{"id":"1*41XiwBL9NXDfGtIXbc3UsQ.jpeg","originalWidth":3000,"originalHeight":2000,"isFeatured":true}},"type":"Tag"},{"slug":"hacking","name":"Hacking","postCount":5405,"virtuals":{"isFollowing":false},"metadata":{"followerCount":2074,"postCount":5405,"coverImage":{"id":"1*IDuLzsAoDpEBNwjwtH9PzQ.png","originalWidth":2250,"originalHeight":1500,"isFeatured":true}},"type":"Tag"}],"socialRecommendsCount":0,"responsesCreatedCount":0,"links":{"entries":[{"url":"https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/","alts":[{"type":1,"url":"https://cdn.ampproject.org/c/s/blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/amp/"}],"httpStatus":200},{"url":"https://room362.com/post/2016/kerberoast-pt1/","alts":[],"httpStatus":200},{"url":"https://www.blackhillsinfosec.com/a-toast-to-kerberoast/","alts":[],"httpStatus":200},{"url":"https://files.sans.org/summit/hackfest2014/PDFs/Kicking%20the%20Guard%20Dog%20of%20Hades%20-%20Attacking%20Microsoft%20Kerberos%20-%20Tim%20Medin(1).pdf","alts":[],"httpStatus":404},{"url":"https://1337red.wordpress.com/using-a-scf-file-to-gather-hashes/","alts":[],"httpStatus":200},{"url":"https://webcache.googleusercontent.com/search?q=cache:BV8AEB0cWtcJ:https://dazzlepod.com/uniqpass/+&cd=1&hl=en&ct=clnk&gl=us","alts":[],"httpStatus":200},{"url":"https://www.sans.org/reading-room/whitepapers/testing/pass-the-hash-attacks-tools-mitigation-33283","alts":[],"httpStatus":200},{"url":"https://github.com/CoreSecurity/impacket/blob/master/examples/wmiexec.py","alts":[],"httpStatus":200},{"url":"https://github.com/purpleteam/snarf","alts":[],"httpStatus":200},{"url":"https://github.com/Kevin-Robertson/Inveigh","alts":[],"httpStatus":200},{"url":"https://github.com/trustedsec/hate_crack","alts":[],"httpStatus":200},{"url":"https://github.com/CoreSecurity/impacket/blob/master/examples/ntlmrelayx.py","alts":[],"httpStatus":200},{"url":"https://github.com/CoreSecurity/impacket","alts":[],"httpStatus":200},{"url":"http://davenport.sourceforge.net/ntlm.html","alts":[],"httpStatus":200},{"url":"https://github.com/CoreSecurity/impacket/blob/impacket_0_9_15/examples/smbrelayx.py","alts":[],"httpStatus":200},{"url":"https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS17-010/ms17_010_eternalblue.rb","alts":[],"httpStatus":200},{"url":"https://github.com/fox-it/mitm6","alts":[],"httpStatus":200},{"url":"https://github.com/lgandx/Responder","alts":[],"httpStatus":200},{"url":"https://twitter.com/TimMedin","alts":[{"type":2,"url":"twitter://user?screen_name=TimMedin"},{"type":3,"url":"twitter://user?screen_name=TimMedin"}],"httpStatus":200},{"url":"https://www.fox-it.com/en/insights/blogs/blog/inside-windows-network/","alts":[],"httpStatus":200},{"url":"https://isc.sans.edu/forums/diary/Using+nmap+to+scan+for+MS17010+CVE20170143+EternalBlue/22574","alts":[],"httpStatus":200},{"url":"https://isc.sans.edu/forums/diary/Using+nmap+to+scan+for+MS17010+CVE20170143+EternalBlue/22574/","alts":[],"httpStatus":200},{"url":"https://www.trustwave.com/Resources/SpiderLabs-Blog/Top-Five-Ways-SpiderLabs-Got-Domain-Admin-on-Your-Internal-Network/","alts":[],"httpStatus":200}],"version":"0.3","generatedAt":1520633031830},"isLockedPreviewOnly":false,"takeoverId":"","metaDescription":"","totalClapCount":13,"sectionCount":1,"readingList":0},"coverless":true,"slug":"top-five-ways-i-got-domain-admin-on-your-internal-network-before-lunch-2018-edition","translationSourcePostId":"","translationSourceCreatorId":"","isApprovedTranslation":false,"inResponseToPostId":"","inResponseToRemovedAt":0,"isTitleSynthesized":true,"allowResponses":true,"importedUrl":"","importedPublishedAt":0,"visibility":0,"uniqueSlug":"top-five-ways-i-got-domain-admin-on-your-internal-network-before-lunch-2018-edition-82259ab73aaa","previewContent":{"bodyModel":{"paragraphs":[{"name":"previewImage","type":4,"text":"","layout":10,"metadata":{"id":"1*vnEng8O4sGJ1DENY2SmiqA.png","originalWidth":2139,"originalHeight":1465,"isFeatured":true}},{"name":"5f23","type":3,"text":"Top Five Ways I Got Domain Admin on Your Internal Network before Lunch (2018 Edition)","markups":[],"alignment":1}],"sections":[{"startIndex":0}]},"isFullContent":false},"license":0,"inResponseToMediaResourceId":"","canonicalUrl":"https://medium.com/@adam.toscher/top-five-ways-i-got-domain-admin-on-your-internal-network-before-lunch-2018-edition-82259ab73aaa","approvedHomeCollectionId":"","newsletterId":"","webCanonicalUrl":"https://medium.com/@adam.toscher/top-five-ways-i-got-domain-admin-on-your-internal-network-before-lunch-2018-edition-82259ab73aaa","mediumUrl":"https://medium.com/@adam.toscher/top-five-ways-i-got-domain-admin-on-your-internal-network-before-lunch-2018-edition-82259ab73aaa","migrationId":"","notifyFollowers":true,"notifyTwitter":false,"isSponsored":false,"isRequestToPubDisabled":false,"notifyFacebook":false,"responseHiddenOnParentPostAt":0,"isSeries":false,"isSubscriptionLocked":false,"seriesLastAppendedAt":0,"audioVersionDurationSec":0,"sequenceId":"","isNsfw":false,"isEligibleForRevenue":false,"isBlockedFromHightower":false,"deletedAt":0,"lockedPostSource":0,"hightowerMinimumGuaranteeStartsAt":0,"hightowerMinimumGuaranteeEndsAt":0,"featureLockRequestAcceptedAt":0,"featureLockRequestMinimumGuaranteeAmount":0,"isElevate":false,"mongerRequestType":1,"type":"Post"},"mentionedUsers":[],"collaborators":[],"membershipPlans":[],"collectionUserRelations":[],"mode":null,"references":{"User":{"626cae9ed375":{"userId":"626cae9ed375","name":"Adam Toscher","username":"adam.toscher","createdAt":1500334773422,"lastPostCreatedAt":1520616888366,"imageId":"0*s_J0fTAsy4Azb0dt.","backgroundImageId":"","bio":"Adam is an independent penetration tester who has over 20 years of experience in the technology industry.","twitterScreenName":"","socialStats":{"userId":"626cae9ed375","usersFollowedCount":4,"usersFollowedByCount":16,"type":"SocialStats"},"social":{"userId":"lo_PnKi7DWRkJf6","targetUserId":"626cae9ed375","type":"Social"},"facebookAccountId":"","allowNotes":1,"mediumMemberAt":1506955772000,"isNsfw":false,"type":"User"}},"Social":{"626cae9ed375":{"userId":"lo_PnKi7DWRkJf6","targetUserId":"626cae9ed375","type":"Social"}},"SocialStats":{"626cae9ed375":{"userId":"626cae9ed375","usersFollowedCount":4,"usersFollowedByCount":16,"type":"SocialStats"}}}})
// ]]></script></body></html>